(function(C,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("vue"),require("three")):typeof define=="function"&&define.amd?define(["exports","vue","three"],d):(C=typeof globalThis<"u"?globalThis:C||self,d(C["@janvorisek/drie"]={},C.Vue,C.three))})(this,function(C,d,a){"use strict";const yt=c=>c===void 0?new a.Vector3(0,0,0):"x"in c?new a.Vector3(c.x,c.y,c.z):new a.Vector3(c[0],c[1],c[2]),_t=c=>c===void 0?new a.Vector2(0,0):"x"in c?new a.Vector2(c.x,c.y):new a.Vector2(c[0],c[1]),wt=(c,n,t)=>{t[c].isVector3?t[c].set(n.x,n.y,n.z):"isEuler"in t[c]&&t[c].setFromVector3(n)},L=(c,n,t,e=!0)=>{if(t!==null){if(c[n]!==void 0){const o=yt(c[n]);wt(n,o,t)}e&&d.watch(()=>c[n],()=>{if(c[n]!==void 0){const o=yt(c[n]);wt(n,o,t)}})}},Mt=(c,n,t)=>{t[c].isVector2&&t[c].set(n.x,n.y)},bt=(c,n,t,e=!0)=>{if(t!==null){if(c[n]!==void 0){const o=_t(c[n]);Mt(n,o,t)}e&&d.watch(()=>c[n],()=>{if(c[n]!==void 0){const o=_t(c[n]);Mt(n,o,t)}})}},M=(c,n,t)=>{d.watch(()=>c[n],()=>{t()})};function ee(c,n){n.hasAttribute("position")&&(c.setAttribute("position",n.getAttribute("position")),c.attributes.position.needsUpdate=!0),n.hasAttribute("normal")&&(c.setAttribute("normal",n.getAttribute("normal")),c.attributes.normal.needsUpdate=!0),n.hasAttribute("uv")&&(c.setAttribute("uv",n.getAttribute("uv")),c.attributes.uv.needsUpdate=!0),c.setIndex(n.getIndex()),n.boundingBox!==null&&(c.boundingBox=n.boundingBox),n.boundingSphere&&n.boundingSphere.radius>0&&(c.boundingSphere=n.boundingSphere)}function ie(c){if(c.children.length>0)for(let n=c.children.length-1;n>=0;n--)ie(c.children[n]);if(c.geometry&&c.geometry.dispose(),c.material)if(c.material.length)for(let n=0;n<c.material.length;++n)c.material[n].map&&c.material[n].map.dispose(),c.material[n].lightMap&&c.material[n].lightMap.dispose(),c.material[n].bumpMap&&c.material[n].bumpMap.dispose(),c.material[n].normalMap&&c.material[n].normalMap.dispose(),c.material[n].specularMap&&c.material[n].specularMap.dispose(),c.material[n].envMap&&c.material[n].envMap.dispose(),c.material[n].dispose();else c.material.map&&c.material.map.dispose(),c.material.lightMap&&c.material.lightMap.dispose(),c.material.bumpMap&&c.material.bumpMap.dispose(),c.material.normalMap&&c.material.normalMap.dispose(),c.material.specularMap&&c.material.specularMap.dispose(),c.material.envMap&&c.material.envMap.dispose(),c.material.dispose();return c.removeFromParent(),!0}function K(c){const n=d.inject("scene"),t=d.inject("parent",void 0);d.onMounted(()=>{t?t.add(c):n.add(c)}),d.onUnmounted(()=>{t?t.remove(c):n.remove(c)})}function Je(c,n){const t=d.inject("camera"),e=d.inject("canvas");d.inject("scene");const o=l=>{const u=new a.Raycaster,h=Et(l);u.setFromCamera(h,t.value);const f=u.intersectObjects(c);f.length>0&&n.onClick(f,h)};let i=!1,s=[];const r=l=>{const u=new a.Raycaster,h=Et(l);u.setFromCamera(h,t.value);const f=u.intersectObjects(c);f.length>0?(s=f,i===!1&&n.onMouseEnter(f,h),i=!0,n.onMouseMove(f,h)):(i&&n.onMouseLeave(s,h),i=!1,s=[])};d.onMounted(()=>{if(n.enableRaycasting){if((e==null?void 0:e.value)==null)return;const l=(()=>null).toString();n.onClick.toString()!==l&&(e==null||e.value.addEventListener("click",o)),(n.onMouseEnter.toString()!==l||n.onMouseMove.toString()!==l||n.onMouseLeave.toString()!==l)&&(e==null||e.value.addEventListener("mousemove",r))}}),d.onUnmounted(()=>{if(n.enableRaycasting){if((e==null?void 0:e.value)==null)return;e==null||e.value.removeEventListener("click",o),e==null||e.value.removeEventListener("mousemove",r)}}),d.watch(()=>n.enableRaycasting,l=>{l?(e==null||e.value.addEventListener("click",o),e==null||e.value.addEventListener("mousemove",r)):(e==null||e.value.removeEventListener("click",o),e==null||e.value.removeEventListener("mousemove",r))})}function Et(c){const n=new a.Vector2,t=c.currentTarget.getBoundingClientRect();return n.x=(c.clientX-t.left)/t.width*2-1,n.y=-((c.clientY-t.top)/t.height)*2+1,n}var ce={},_e={},Fe={};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.callHandlers=$n;function St(c,n){let t=null;try{t=c(n)}catch(e){return Promise.reject(e)}return t&&t.then?t:Promise.resolve(t)}function $n(c,n){return!n||n.length===0?new Promise(t=>{}):n.length===1?St(n[0],c):Promise.all(n.map(t=>St(t,c)))}var Ae={};Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.DEFAULT_PARAM=void 0;const Xn="$_DEFAULT_$";Ae.DEFAULT_PARAM=Xn,Object.defineProperty(_e,"__esModule",{value:!0}),_e.slot=qn,_e.connectSlot=Kn,_e.defaultSlotConfig=void 0;var Yn=Fe,Ne=Ae;const et=()=>{throw new Error("Slot not connected")},Tt={noBuffer:!1,autoReconnect:!0};_e.defaultSlotConfig=Tt;const Zn=c=>Object.assign(()=>et(),{config:c,lazy:()=>et,on:()=>et,slotName:"Not connected"}),Ce="LOCAL_TRANSPORT",Le=(c,n)=>Object.keys(n).reduce((t,e)=>t.concat(n[e][c]||[]),[]),xt=c=>Object.keys(c).reduce((n,t)=>{const e=c[t],o=Object.keys(e).filter(r=>(e[r]||[]).length>0),i=[...n,...o];return[...new Set(i)]},[]);function qn(c=Tt){return Zn(c)}function Kn(c,n,t={}){const e=n.reduce((p,y,_)=>({...p,[_]:{}}),{[Ce]:{}}),o=n.reduce((p,y,_)=>({...p,[_]:{}}),{}),i=(p,y)=>{let _=()=>{};const E=new Promise(w=>_=w);o[p][y]={registered:E,onRegister:_}},s=[],r=[],l=p=>s.forEach(y=>y(p)),u=p=>r.forEach(y=>y(p));n.forEach((p,y)=>{const _=(b=Ne.DEFAULT_PARAM,T)=>{if(!o[y])return;const A=e[y][b]||[];e[y][b]=A.concat(T),Le(b,e).length===1&&l(b),o[y][b]||i(String(y),b),o[y][b].onRegister()},E=(b=Ne.DEFAULT_PARAM,T)=>{const x=(e[y][b]||[]).indexOf(T);x>-1&&e[y][b].splice(x,1),Le(b,e).length===0&&u(b),o[y]&&i(String(y),b)},w=()=>{o[y]&&Object.keys(o[y]).forEach(b=>{o[y][b].onRegister()}),delete o[y]};p.addRemoteHandlerRegistrationCallback(c,_),p.addRemoteHandlerUnregistrationCallback(c,E),p.addRemoteEventListChangedListener(c,w)});function h(p,y){const _=arguments.length===2,E=_?y:p,w=_?p:Ne.DEFAULT_PARAM,b=()=>{const A=Le(w,e);return(0,Yn.callHandlers)(E,A)};if(n.length===0)return b();const T=[];if(t.autoReconnect&&n.forEach(A=>{T.push(A.autoReconnect())}),t.noBuffer)return Promise.all(T).then(()=>b());{n.forEach((x,O)=>{o[O]&&!o[O][w]&&i(String(O),w)});const A=n.reduce((x,O,D)=>{var k;return[...x,...(k=o[D]&&[o[D][w].registered])!==null&&k!==void 0?k:[]]},[]);return Promise.all(A).then(()=>b())}}function f(p,y){return s.push(p),r.push(y),xt(e).forEach(p),()=>{xt(e).forEach(y);const _=s.indexOf(p);_>-1&&s.splice(_,1);const E=r.indexOf(y);E>-1&&r.splice(E,1)}}function m(p,y){let _="",E=()=>new Promise(b=>b());return typeof p=="string"?(_=p,E=y||E):(_=Ne.DEFAULT_PARAM,E=p),n.forEach(b=>b.registerHandler(c,_,E)),e[Ce][_]=(e[Ce][_]||[]).concat(E),Le(_,e).length===1&&l(_),()=>{n.forEach(x=>x.unregisterHandler(c,_,E));const T=(e[Ce][_]||[]).indexOf(E);T!==-1&&e[Ce][_].splice(T,1),Le(_,e).length===0&&u(_)}}return Object.assign(h,{on:m,lazy:f,config:t,slotName:c})}var Be={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.Transport=void 0;var Qn=Fe;let Wn=0;const Jn=()=>`${Wn++}`,eo=c=>{throw new Error(`Should not happen: ${c}`)},tt={TIMED_OUT:"TIMED_OUT",REMOTE_CONNECTION_CLOSED:"REMOTE_CONNECTION_CLOSED",CHANNEL_NOT_READY:"CHANNEL_NOT_READY"};class to{constructor(n,t){this._channel=n,this._localHandlers={},this._localHandlerRegistrations={},this._remoteHandlers={},this._remoteHandlerRegistrationCallbacks={},this._remoteHandlerDeletionCallbacks={},this._remoteIgnoredEventsCallbacks={},this._pendingRequests={},this._channelReady=!1,this._channel.onData(e=>{switch(e.type){case"request":return this._requestReceived(e);case"response":return this._responseReceived(e);case"handler_registered":return this._registerRemoteHandler(e);case"handler_unregistered":return this._unregisterRemoteHandler(e);case"error":return this._errorReceived(e);case"event_list":return this._remoteIgnoredEventsReceived(e);default:eo(e)}}),this._channel.onConnect(()=>{this._channelReady=!0,Object.keys(this._localHandlerRegistrations).forEach(e=>{this._localHandlerRegistrations[e].forEach(o=>{this._channel.send(o)})}),t&&this._channel.send({type:"event_list",ignoredEvents:t})}),this._channel.onDisconnect(()=>{this._channelReady=!1,this._unregisterAllRemoteHandlers(),this._rejectAllPendingRequests(new Error(`${tt.REMOTE_CONNECTION_CLOSED}`))}),this._channel.onError(e=>this._rejectAllPendingRequests(e))}_remoteIgnoredEventsReceived({ignoredEvents:n}){Object.keys(this._remoteIgnoredEventsCallbacks).forEach(t=>{n.includes(t)&&this._remoteIgnoredEventsCallbacks[t]()})}_requestReceived({slotName:n,data:t,id:e,param:o}){const i=this._localHandlers[n];if(!i)return;const s=i[o];s&&(0,Qn.callHandlers)(t,s).then(r=>this._channel.send({type:"response",slotName:n,id:e,data:r,param:o})).catch(r=>this._channel.send({id:e,message:`${r}`,param:o,slotName:n,stack:r.stack||"",type:"error"}))}_responseReceived({slotName:n,data:t,id:e,param:o}){const i=this._pendingRequests[n];!i||!i[o]||!i[o][e]||(i[o][e].resolve(t),delete i[o][e])}_errorReceived({slotName:n,id:t,message:e,stack:o,param:i}){const s=this._pendingRequests[n];if(!s||!s[i]||!s[i][t])return;const r=new Error(`${e} on ${n} with param ${i}`);r.stack=o||r.stack,this._pendingRequests[n][i][t].reject(r),delete this._pendingRequests[n][i][t]}_registerRemoteHandler({slotName:n,param:t}){const e=this._remoteHandlerRegistrationCallbacks[n];if(!e)return;const o=this._remoteHandlers[n];if(o&&o[t])return;const i=s=>new Promise((r,l)=>{if(!this._channelReady)return l(new Error(`${tt.CHANNEL_NOT_READY} on ${n}`));const u=Jn();this._pendingRequests[n]=this._pendingRequests[n]||{},this._pendingRequests[n][t]=this._pendingRequests[n][t]||{},this._pendingRequests[n][t][u]={resolve:r,reject:l},this._channel.send({type:"request",id:u,slotName:n,param:t,data:s}),setTimeout(()=>{const m=((this._pendingRequests[n]||{})[t]||{})[u];if(m){const p=new Error(`${tt.TIMED_OUT} on ${n} with param ${t}`);m.reject(p),delete this._pendingRequests[n][t][u]}},this._channel.timeout)});this._remoteHandlers[n]=this._remoteHandlers[n]||{},this._remoteHandlers[n][t]=i,e(t,i)}_unregisterRemoteHandler({slotName:n,param:t}){const e=this._remoteHandlerDeletionCallbacks[n],o=this._remoteHandlers[n];if(!o)return;const i=o[t];i&&e&&(e(t,i),delete this._remoteHandlers[n][t])}_unregisterAllRemoteHandlers(){Object.keys(this._remoteHandlerDeletionCallbacks).forEach(n=>{const t=this._remoteHandlers[n];if(!t)return;Object.keys(t).filter(o=>t[o]).forEach(o=>this._unregisterRemoteHandler({slotName:n,param:o}))})}_rejectAllPendingRequests(n){Object.keys(this._pendingRequests).forEach(t=>{Object.keys(this._pendingRequests[t]).forEach(e=>{Object.keys(this._pendingRequests[t][e]).forEach(o=>{this._pendingRequests[t][e][o].reject(n)})}),this._pendingRequests[t]={}})}addRemoteHandlerRegistrationCallback(n,t){this._remoteHandlerRegistrationCallbacks[n]||(this._remoteHandlerRegistrationCallbacks[n]=t)}addRemoteHandlerUnregistrationCallback(n,t){this._remoteHandlerDeletionCallbacks[n]||(this._remoteHandlerDeletionCallbacks[n]=t)}addRemoteEventListChangedListener(n,t){this._remoteIgnoredEventsCallbacks[n]||(this._remoteIgnoredEventsCallbacks[n]=t)}registerHandler(n,t,e){if(this._localHandlers[n]=this._localHandlers[n]||{},this._localHandlers[n][t]=this._localHandlers[n][t]||[],this._localHandlers[n][t].push(e),this._localHandlers[n][t].length===1){const o={type:"handler_registered",param:t,slotName:n};this._localHandlerRegistrations[t]=this._localHandlerRegistrations[t]||[],this._localHandlerRegistrations[t].push(o),this._channelReady&&this._channel.send(o)}}unregisterHandler(n,t,e){const o=this._localHandlers[n];if(o&&o[t]){const i=o[t].indexOf(e);if(i>-1&&(o[t].splice(i,1),o[t].length===0)){const s={type:"handler_unregistered",param:t,slotName:n};this._channelReady&&this._channel.send(s)}}}isDisconnected(){return!this._channelReady}autoReconnect(){if(this.isDisconnected()&&this._channel.autoReconnect){const n=new Promise(t=>{this._channel.onConnect(()=>t())});return this._channel.autoReconnect(),n}return Promise.resolve()}}Ue.Transport=to,Object.defineProperty(Be,"__esModule",{value:!0}),Be.combineEvents=so,Be.createEventBus=io;var no=_e,oo=Ue;function so(...c){const n=c.reduce((e,o)=>(e.push.apply(e,Object.keys(o)),e),[]),t=[...new Set(n)];if(n.length>t.length)throw new Error("ts-event-bus: duplicate slots encountered in combineEvents.");return Object.assign({},...c)}function io(c){const n=(c.channels||[]).map(e=>new oo.Transport(e,c.ignoredEvents)),t={};for(const e in c.events)c.events.hasOwnProperty(e)&&(!c.ignoredEvents||c.ignoredEvents&&!c.ignoredEvents.includes(e))&&(t[e]=(0,no.connectSlot)(e,n,c.events[e].config));return t}var ao={},Re={};Object.defineProperty(Re,"__esModule",{value:!0}),Re.GenericChannel=void 0;const ro=5e3;class co{constructor(n=ro){this._timeout=n,this._onMessageCallbacks=[],this._onConnectCallbacks=[],this._onDisconnectCallbacks=[],this._onErrorCallbacks=[],this._ready=!1}get timeout(){return this._timeout}onData(n){this._onMessageCallbacks.indexOf(n)===-1&&this._onMessageCallbacks.push(n)}onConnect(n){this._ready&&n(),this._onConnectCallbacks.push(n)}onDisconnect(n){this._onDisconnectCallbacks.push(n)}onError(n){this._onErrorCallbacks.push(n)}_messageReceived(n){this._onMessageCallbacks.forEach(t=>t(n))}_error(n){this._onErrorCallbacks.forEach(t=>t(n))}_connected(){this._ready=!0,this._onConnectCallbacks.forEach(n=>n())}_disconnected(){this._ready=!1,this._onDisconnectCallbacks.forEach(n=>n())}}Re.GenericChannel=co;var Ve={},ze={};Object.defineProperty(ze,"__esModule",{value:!0}),ze.isTransportMessage=lo;function lo(c){switch(c.type){case"request":case"response":case"error":case"handler_unregistered":case"handler_registered":case"event_list":return!0;default:return!1}}Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.ChunkedChannel=void 0;var uo=Re,fo=ze;const Se={getRandomId:()=>[...Array(30)].map(()=>Math.random().toString(36)[3]).join(""),str2byteArray:c=>{const n=new Uint16Array(c.length);for(let t=0,e=c.length;t<e;t++)n[t]=c.charCodeAt(t);return n},convertUintArrayToString:(c,n)=>{if(n===-1)return String.fromCharCode.apply(null,c);{let t="";for(let e=0;e<c.length;e+=n)e+n>c.length?t+=String.fromCharCode.apply(null,c.subarray(e)):t+=String.fromCharCode.apply(null,c.subarray(e,e+n));return t}},checkForChunkId:c=>{if(!c.chunkId)throw new Error(`ChunkedMessage did not have a chunkId: ${JSON.stringify(c)}`)}};class ho extends uo.GenericChannel{constructor(n){super(n.timeout),this._chunkSize=void 0,this._maxStringAlloc=void 0,this._sender=void 0,this._buffer={},this._chunkSize=n.chunkSize,this._sender=n.sender,this._maxStringAlloc=n.maxStringAlloc||-1}send(n){const t=JSON.stringify(n);if(t.length<=this._chunkSize){this._sender(n);return}const e=Se.str2byteArray(t),o=Se.getRandomId();this._sender({type:"chunk_start",chunkId:o,size:t.length});const i=(s=0)=>{let r=e.slice(s,s+this._chunkSize);r.length&&(this._sender({type:"chunk_data",chunkId:o,data:Array.from(r)}),i(s+this._chunkSize))};i(),this._sender({type:"chunk_end",chunkId:o})}_messageReceived(n){switch(n.type){case"chunk_start":this._receiveNewChunk(n);break;case"chunk_data":this._receiveChunkData(n);break;case"chunk_end":const t=this._mergeChunks(n);super._messageReceived(t);break;default:super._messageReceived(n)}}_receiveNewChunk(n){if(Se.checkForChunkId(n),this._buffer[n.chunkId])throw new Error(`There was already an entry in the buffer for chunkId ${n.chunkId}`);this._buffer[n.chunkId]={id:n.chunkId,chunks:[],size:n.size}}_receiveChunkData(n){if(Se.checkForChunkId(n),!this._buffer[n.chunkId])throw new Error(`ChunkId ${n.chunkId} was not found in the buffer`);this._buffer[n.chunkId].chunks.push(n.data)}_mergeChunks(n){if(Se.checkForChunkId(n),!this._buffer[n.chunkId])throw new Error(`ChunkId ${n.chunkId} was not found in the buffer`);const t=this._buffer[n.chunkId].chunks.reduce((i,s,r)=>(s.forEach((l,u)=>i.uintArray[i.currentIx+u]=l),i.currentIx+=s.length,i),{uintArray:new Uint16Array(this._buffer[n.chunkId].size),currentIx:0});let e;const o=Se.convertUintArrayToString(t.uintArray,this._maxStringAlloc);try{e=JSON.parse(o)}catch{throw new Error(`Not a valid JSON string: ${o}`)}if(!(0,fo.isTransportMessage)(e))throw new Error(`Not a transport message: ${JSON.stringify(e)}`);return e}}Ve.ChunkedChannel=ho,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"slot",{enumerable:!0,get:function(){return n.slot}}),Object.defineProperty(c,"Slot",{enumerable:!0,get:function(){return n.Slot}}),Object.defineProperty(c,"EventDeclaration",{enumerable:!0,get:function(){return t.EventDeclaration}}),Object.defineProperty(c,"combineEvents",{enumerable:!0,get:function(){return t.combineEvents}}),Object.defineProperty(c,"createEventBus",{enumerable:!0,get:function(){return t.createEventBus}}),Object.defineProperty(c,"Channel",{enumerable:!0,get:function(){return e.Channel}}),Object.defineProperty(c,"GenericChannel",{enumerable:!0,get:function(){return o.GenericChannel}}),Object.defineProperty(c,"ChunkedChannel",{enumerable:!0,get:function(){return i.ChunkedChannel}}),Object.defineProperty(c,"TransportMessage",{enumerable:!0,get:function(){return s.TransportMessage}}),Object.defineProperty(c,"DEFAULT_PARAM",{enumerable:!0,get:function(){return r.DEFAULT_PARAM}});var n=_e,t=Be,e=ao,o=Re,i=Ve,s=ze,r=Ae}(ce);const po={geometryChanged:ce.slot(),object3DChanged:ce.slot(),object3DTranslated:ce.slot(),sayHello:ce.slot(),getTime:ce.slot(),multiply:ce.slot(),ping:ce.slot()},I=ce.createEventBus({events:po}),At=d.defineComponent({__name:"Renderer",props:{alpha:{type:Boolean,default:!1},antialias:{type:Boolean,default:!1},autoResize:{type:Boolean,default:!0},camera:null,height:{default:0},frameLimit:{default:60},onBeforeRender:{type:Function,default:()=>{}},shadowMapEnabled:{type:Boolean,default:!1},width:{default:0}},setup(c,{expose:n}){const t=c;let e=d.ref(null);const o=[],i=d.reactive([]),s=d.reactive([]);let r=d.ref(null);const l=d.ref([]),u=d.ref([]),h=d.ref();d.provide("canvas",h);let f=!0,m=Date.now(),p=1e3/t.frameLimit;d.watch(()=>t.camera,w=>y(w));const y=w=>{if(w){const b=l.value.find(T=>T.name===w);b===void 0&&(r.value=null),r.value=b}else r.value=l.value[0]};function _(){e.value!==null&&(e.value.shadowMap.enabled=t.shadowMapEnabled,p=1e3/t.frameLimit,t.autoResize||e.value.setSize(t.width,t.height))}d.onMounted(()=>{e.value=new a.WebGLRenderer({canvas:h.value,antialias:t.antialias,alpha:t.alpha}),e.value.setSize(1,1),_(),y(t.camera),new ResizeObserver(b=>{b.forEach(T=>{e.value&&t.autoResize&&e.value.setSize(T.contentRect.width,T.contentRect.height)})}).observe(h.value.parentElement),E()}),d.onUnmounted(()=>{for(let w of o)ie(w)});function E(){if(requestAnimationFrame(E),e.value===null)return;const w=Date.now(),b=w-m;if(!(p>-1&&b<p)){if(m=w-b%p,t.onBeforeRender&&t.onBeforeRender(),u.value.length>0&&r.value)for(const T of u.value)T.value!==null&&(T.value.object.uuid===r.value.uuid?(T.value.enabled=f,T.value.update()):T.value.enabled=!1);if(r.value&&e)for(const T of o)e.value.render(T,r.value)}}return _(),d.watch(()=>t.shadowMapEnabled,()=>_()),d.watch(()=>t.frameLimit,()=>_()),d.watch(()=>t.width,()=>_()),d.watch(()=>t.height,()=>_()),d.provide("addCamera",w=>l.value.push(w)),d.provide("addScene",w=>o.push(w)),d.provide("addGeometry",w=>i.push(w)),d.provide("getGeometry",w=>i.find(b=>b.name===w)),d.provide("addMaterial",w=>s.push(w)),d.provide("getMaterial",w=>s.find(b=>b.name===w)),d.provide("addControls",w=>u.value.push(w)),d.provide("enableAllControls",()=>{f=!0}),d.provide("disableAllControls",()=>{f=!1}),d.provide("camera",r),n({three:e,eventBus:I}),(w,b)=>(d.openBlock(),d.createElementBlock(d.Fragment,null,[d.createElementVNode("canvas",{ref_key:"canvas",ref:h},null,512),d.renderSlot(w.$slots,"default")],64))}}),Ct=d.defineComponent({__name:"Scene",props:{background:{default:16777215}},setup(c,{expose:n}){const t=c,e=new a.Scene;d.provide("scene",e),d.inject("addScene")(e);function o(i){i.background&&(e.background=new a.Color(i.background))}return o(t),d.watch(()=>t.background,()=>o(t)),n({three:e}),(i,s)=>d.renderSlot(i.$slots,"default")}}),mo={name:"PerspectiveCamera"},Lt=d.defineComponent({...mo,props:{aspect:{default:1},autoResize:{type:Boolean,default:!0},far:{default:2e3},lookAt:{default:()=>[0,0,0]},name:{default:""},near:{default:.1},position:{default:()=>[0,0,0]},up:{default:()=>[0,1,0]}},setup(c,{expose:n}){const t=c,e=new a.PerspectiveCamera(75,window.innerWidth/window.innerHeight*1e3,.1,1e3);d.inject("addCamera")(e);const o=d.inject("canvas");d.watch(o,()=>{new ResizeObserver(r=>{r.forEach(l=>{t.autoResize&&(e.aspect=l.contentRect.width/l.contentRect.height,e.updateProjectionMatrix())})}).observe(o.value)}),L(t,"position",e),L(t,"up",e),L(t,"lookAt",e);function i(){e.name=t.name,t.autoResize||(e.aspect=t.aspect),e.near=t.near,e.far=t.far,e.updateProjectionMatrix()}return i(),M(t,"name",i),M(t,"aspect",i),M(t,"near",i),M(t,"far",i),d.provide("parentCamera",e),n({three:e}),(s,r)=>d.renderSlot(s.$slots,"default")}}),go={name:"OrthographicCamera"},Rt=d.defineComponent({...go,props:{far:{default:2e3},lookAt:{default:()=>[0,0,0]},name:{default:""},near:{default:.1},position:{default:()=>[0,0,0]},up:{default:()=>[0,1,0]}},setup(c,{expose:n}){const t=c,e=new a.OrthographicCamera(-10,10,10,-10,.1,1e3);e.lookAt(0,0,0),e.updateProjectionMatrix(),d.inject("addCamera")(e);const o=d.inject("canvas");d.watch(o,()=>{new ResizeObserver(r=>{r.forEach(l=>{const u=l.contentRect.width/l.contentRect.height;e.left=e.bottom*u,e.right=e.top*u,e.updateProjectionMatrix()})}).observe(o.value)}),L(t,"position",e),L(t,"up",e),L(t,"lookAt",e);function i(){e.name=t.name,e.near=t.near,e.far=t.far,e.updateProjectionMatrix()}return i(),M(t,"name",i),M(t,"near",i),M(t,"far",i),d.provide("parentCamera",e),n({three:e}),(s,r)=>d.renderSlot(s.$slots,"default")}}),Pt={type:"change"},nt={type:"start"},vt={type:"end"};class yo extends a.EventDispatcher{constructor(n,t){super(),t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=n,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new a.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:a.MOUSE.ROTATE,MIDDLE:a.MOUSE.DOLLY,RIGHT:a.MOUSE.PAN},this.touches={ONE:a.TOUCH.ROTATE,TWO:a.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(g){g.addEventListener("keydown",Nn),this._domElementKeyEvents=g},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Pt),e.update(),i=o.NONE},this.update=function(){const g=new a.Vector3,R=new a.Quaternion().setFromUnitVectors(n.up,new a.Vector3(0,1,0)),X=R.clone().invert(),q=new a.Vector3,se=new a.Quaternion,xe=2*Math.PI;return function(){const zn=e.object.position;g.copy(zn).sub(e.target),g.applyQuaternion(R),r.setFromVector3(g),e.autoRotate&&i===o.NONE&&z(D()),e.enableDamping?(r.theta+=l.theta*e.dampingFactor,r.phi+=l.phi*e.dampingFactor):(r.theta+=l.theta,r.phi+=l.phi);let de=e.minAzimuthAngle,fe=e.maxAzimuthAngle;return isFinite(de)&&isFinite(fe)&&(de<-Math.PI?de+=xe:de>Math.PI&&(de-=xe),fe<-Math.PI?fe+=xe:fe>Math.PI&&(fe-=xe),de<=fe?r.theta=Math.max(de,Math.min(fe,r.theta)):r.theta=r.theta>(de+fe)/2?Math.max(de,r.theta):Math.min(fe,r.theta)),r.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,r.phi)),r.makeSafe(),r.radius*=u,r.radius=Math.max(e.minDistance,Math.min(e.maxDistance,r.radius)),e.enableDamping===!0?e.target.addScaledVector(h,e.dampingFactor):e.target.add(h),g.setFromSpherical(r),g.applyQuaternion(X),zn.copy(e.target).add(g),e.object.lookAt(e.target),e.enableDamping===!0?(l.theta*=1-e.dampingFactor,l.phi*=1-e.dampingFactor,h.multiplyScalar(1-e.dampingFactor)):(l.set(0,0,0),h.set(0,0,0)),u=1,f||q.distanceToSquared(e.object.position)>s||8*(1-se.dot(e.object.quaternion))>s?(e.dispatchEvent(Pt),q.copy(e.object.position),se.copy(e.object.quaternion),f=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Bn),e.domElement.removeEventListener("pointerdown",Ee),e.domElement.removeEventListener("pointercancel",Hn),e.domElement.removeEventListener("wheel",Fn),e.domElement.removeEventListener("pointermove",pt),e.domElement.removeEventListener("pointerup",mt),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",Nn)};const e=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=o.NONE;const s=1e-6,r=new a.Spherical,l=new a.Spherical;let u=1;const h=new a.Vector3;let f=!1;const m=new a.Vector2,p=new a.Vector2,y=new a.Vector2,_=new a.Vector2,E=new a.Vector2,w=new a.Vector2,b=new a.Vector2,T=new a.Vector2,A=new a.Vector2,x=[],O={};function D(){return 2*Math.PI/60/60*e.autoRotateSpeed}function k(){return Math.pow(.95,e.zoomSpeed)}function z(g){l.theta-=g}function j(g){l.phi-=g}const B=function(){const g=new a.Vector3;return function(X,q){g.setFromMatrixColumn(q,0),g.multiplyScalar(-X),h.add(g)}}(),W=function(){const g=new a.Vector3;return function(X,q){e.screenSpacePanning===!0?g.setFromMatrixColumn(q,1):(g.setFromMatrixColumn(q,0),g.crossVectors(e.object.up,g)),g.multiplyScalar(X),h.add(g)}}(),N=function(){const g=new a.Vector3;return function(X,q){const se=e.domElement;if(e.object.isPerspectiveCamera){const xe=e.object.position;g.copy(xe).sub(e.target);let We=g.length();We*=Math.tan(e.object.fov/2*Math.PI/180),B(2*X*We/se.clientHeight,e.object.matrix),W(2*q*We/se.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(B(X*(e.object.right-e.object.left)/e.object.zoom/se.clientWidth,e.object.matrix),W(q*(e.object.top-e.object.bottom)/e.object.zoom/se.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function U(g){e.object.isPerspectiveCamera?u/=g:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*g)),e.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function H(g){e.object.isPerspectiveCamera?u*=g:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/g)),e.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ne(g){m.set(g.clientX,g.clientY)}function Y(g){b.set(g.clientX,g.clientY)}function J(g){_.set(g.clientX,g.clientY)}function $(g){p.set(g.clientX,g.clientY),y.subVectors(p,m).multiplyScalar(e.rotateSpeed);const R=e.domElement;z(2*Math.PI*y.x/R.clientHeight),j(2*Math.PI*y.y/R.clientHeight),m.copy(p),e.update()}function me(g){T.set(g.clientX,g.clientY),A.subVectors(T,b),A.y>0?U(k()):A.y<0&&H(k()),b.copy(T),e.update()}function ge(g){E.set(g.clientX,g.clientY),w.subVectors(E,_).multiplyScalar(e.panSpeed),N(w.x,w.y),_.copy(E),e.update()}function ue(g){g.deltaY<0?H(k()):g.deltaY>0&&U(k()),e.update()}function Ge(g){let R=!1;switch(g.code){case e.keys.UP:N(0,e.keyPanSpeed),R=!0;break;case e.keys.BOTTOM:N(0,-e.keyPanSpeed),R=!0;break;case e.keys.LEFT:N(e.keyPanSpeed,0),R=!0;break;case e.keys.RIGHT:N(-e.keyPanSpeed,0),R=!0;break}R&&(g.preventDefault(),e.update())}function ye(){if(x.length===1)m.set(x[0].pageX,x[0].pageY);else{const g=.5*(x[0].pageX+x[1].pageX),R=.5*(x[0].pageY+x[1].pageY);m.set(g,R)}}function He(){if(x.length===1)_.set(x[0].pageX,x[0].pageY);else{const g=.5*(x[0].pageX+x[1].pageX),R=.5*(x[0].pageY+x[1].pageY);_.set(g,R)}}function Qe(){const g=x[0].pageX-x[1].pageX,R=x[0].pageY-x[1].pageY,X=Math.sqrt(g*g+R*R);b.set(0,X)}function S(){e.enableZoom&&Qe(),e.enablePan&&He()}function P(){e.enableZoom&&Qe(),e.enableRotate&&ye()}function V(g){if(x.length==1)p.set(g.pageX,g.pageY);else{const X=gt(g),q=.5*(g.pageX+X.x),se=.5*(g.pageY+X.y);p.set(q,se)}y.subVectors(p,m).multiplyScalar(e.rotateSpeed);const R=e.domElement;z(2*Math.PI*y.x/R.clientHeight),j(2*Math.PI*y.y/R.clientHeight),m.copy(p)}function Z(g){if(x.length===1)E.set(g.pageX,g.pageY);else{const R=gt(g),X=.5*(g.pageX+R.x),q=.5*(g.pageY+R.y);E.set(X,q)}w.subVectors(E,_).multiplyScalar(e.panSpeed),N(w.x,w.y),_.copy(E)}function oe(g){const R=gt(g),X=g.pageX-R.x,q=g.pageY-R.y,se=Math.sqrt(X*X+q*q);T.set(0,se),A.set(0,Math.pow(T.y/b.y,e.zoomSpeed)),U(A.y),b.copy(T)}function re(g){e.enableZoom&&oe(g),e.enablePan&&Z(g)}function Gn(g){e.enableZoom&&oe(g),e.enableRotate&&V(g)}function Ee(g){e.enabled!==!1&&(x.length===0&&(e.domElement.setPointerCapture(g.pointerId),e.domElement.addEventListener("pointermove",pt),e.domElement.addEventListener("pointerup",mt)),Fs(g),g.pointerType==="touch"?Gs(g):js(g))}function pt(g){e.enabled!==!1&&(g.pointerType==="touch"?Hs(g):Ds(g))}function mt(g){Un(g),x.length===0&&(e.domElement.releasePointerCapture(g.pointerId),e.domElement.removeEventListener("pointermove",pt),e.domElement.removeEventListener("pointerup",mt)),e.dispatchEvent(vt),i=o.NONE}function Hn(g){Un(g)}function js(g){let R;switch(g.button){case 0:R=e.mouseButtons.LEFT;break;case 1:R=e.mouseButtons.MIDDLE;break;case 2:R=e.mouseButtons.RIGHT;break;default:R=-1}switch(R){case a.MOUSE.DOLLY:if(e.enableZoom===!1)return;Y(g),i=o.DOLLY;break;case a.MOUSE.ROTATE:if(g.ctrlKey||g.metaKey||g.shiftKey){if(e.enablePan===!1)return;J(g),i=o.PAN}else{if(e.enableRotate===!1)return;ne(g),i=o.ROTATE}break;case a.MOUSE.PAN:if(g.ctrlKey||g.metaKey||g.shiftKey){if(e.enableRotate===!1)return;ne(g),i=o.ROTATE}else{if(e.enablePan===!1)return;J(g),i=o.PAN}break;default:i=o.NONE}i!==o.NONE&&e.dispatchEvent(nt)}function Ds(g){if(e.enabled!==!1)switch(i){case o.ROTATE:if(e.enableRotate===!1)return;$(g);break;case o.DOLLY:if(e.enableZoom===!1)return;me(g);break;case o.PAN:if(e.enablePan===!1)return;ge(g);break}}function Fn(g){e.enabled===!1||e.enableZoom===!1||i!==o.NONE||(g.preventDefault(),e.dispatchEvent(nt),ue(g),e.dispatchEvent(vt))}function Nn(g){e.enabled===!1||e.enablePan===!1||Ge(g)}function Gs(g){switch(Vn(g),x.length){case 1:switch(e.touches.ONE){case a.TOUCH.ROTATE:if(e.enableRotate===!1)return;ye(),i=o.TOUCH_ROTATE;break;case a.TOUCH.PAN:if(e.enablePan===!1)return;He(),i=o.TOUCH_PAN;break;default:i=o.NONE}break;case 2:switch(e.touches.TWO){case a.TOUCH.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;S(),i=o.TOUCH_DOLLY_PAN;break;case a.TOUCH.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;P(),i=o.TOUCH_DOLLY_ROTATE;break;default:i=o.NONE}break;default:i=o.NONE}i!==o.NONE&&e.dispatchEvent(nt)}function Hs(g){switch(Vn(g),i){case o.TOUCH_ROTATE:if(e.enableRotate===!1)return;V(g),e.update();break;case o.TOUCH_PAN:if(e.enablePan===!1)return;Z(g),e.update();break;case o.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;re(g),e.update();break;case o.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Gn(g),e.update();break;default:i=o.NONE}}function Bn(g){e.enabled!==!1&&g.preventDefault()}function Fs(g){x.push(g)}function Un(g){delete O[g.pointerId];for(let R=0;R<x.length;R++)if(x[R].pointerId==g.pointerId){x.splice(R,1);return}}function Vn(g){let R=O[g.pointerId];R===void 0&&(R=new a.Vector2,O[g.pointerId]=R),R.set(g.pageX,g.pageY)}function gt(g){const R=g.pointerId===x[0].pointerId?x[1]:x[0];return O[R.pointerId]}e.domElement.addEventListener("contextmenu",Bn),e.domElement.addEventListener("pointerdown",Ee),e.domElement.addEventListener("pointercancel",Hn),e.domElement.addEventListener("wheel",Fn,{passive:!1}),this.update()}}const _o={name:"OrbitControls",render:()=>null},Ot=d.defineComponent({..._o,props:{enablePan:{type:Boolean,default:!0},enableRotate:{type:Boolean,default:!0},enableZoom:{type:Boolean,default:!0},minZoom:{default:0},maxZoom:{default:1/0},minDistance:{default:0},maxDistance:{default:1/0},minPolarAngle:{default:0},maxPolarAngle:{default:Math.PI},minAzimuthAngle:{default:1/0},maxAzimuthAngle:{default:1/0},target:{default:()=>[0,0,0]}},setup(c,{expose:n}){const t=c,e=d.ref(null);d.inject("addControls")(e);const o=d.inject("parentCamera"),i=d.inject("canvas");function s(){e.value!=null&&(e.value.enablePan=t.enablePan,e.value.enableRotate=t.enableRotate,e.value.enableZoom=t.enableZoom,e.value.minZoom=t.minZoom,e.value.maxZoom=t.maxZoom,e.value.minDistance=t.minDistance,e.value.maxDistance=t.maxDistance,e.value.minPolarAngle=t.minPolarAngle,e.value.maxPolarAngle=t.maxPolarAngle,e.value.minAzimuthAngle=t.minAzimuthAngle,e.value.maxAzimuthAngle=t.maxAzimuthAngle)}let r=!1;const l=()=>{i.value&&(r||(e.value=new yo(o,i.value),s(),L(t,"target",e.value),r=!0))};return d.watch(i,()=>{l()}),s(),M(t,"enablePan",s),M(t,"enableRotate",s),M(t,"enableZoom",s),M(t,"minZoom",s),M(t,"maxZoom",s),M(t,"minDistance",s),M(t,"maxDistance",s),M(t,"minPolarAngle",s),M(t,"maxPolarAngle",s),M(t,"minAzimuthAngle",s),M(t,"maxAzimuthAngle",s),n({three:e}),{props:t,three:e,camera:o,canvas:i,applyProps:s,get boundCamera(){return r},set boundCamera(u){r=u},tryBindCamera:l}}}),ot={type:"change"},st={type:"start"},it={type:"end"};class wo extends a.EventDispatcher{constructor(n,t){super(),t===void 0&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const e=this,o={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:a.MOUSE.ROTATE,MIDDLE:a.MOUSE.DOLLY,RIGHT:a.MOUSE.PAN},this.target=new a.Vector3;const i=1e-6,s=new a.Vector3;let r=1,l=o.NONE,u=o.NONE,h=0,f=0,m=0;const p=new a.Vector3,y=new a.Vector2,_=new a.Vector2,E=new a.Vector3,w=new a.Vector2,b=new a.Vector2,T=new a.Vector2,A=new a.Vector2,x=[],O={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const S=e.domElement.getBoundingClientRect(),P=e.domElement.ownerDocument.documentElement;e.screen.left=S.left+window.pageXOffset-P.clientLeft,e.screen.top=S.top+window.pageYOffset-P.clientTop,e.screen.width=S.width,e.screen.height=S.height};const D=function(){const S=new a.Vector2;return function(V,Z){return S.set((V-e.screen.left)/e.screen.width,(Z-e.screen.top)/e.screen.height),S}}(),k=function(){const S=new a.Vector2;return function(V,Z){return S.set((V-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-Z))/e.screen.width),S}}();this.rotateCamera=function(){const S=new a.Vector3,P=new a.Quaternion,V=new a.Vector3,Z=new a.Vector3,oe=new a.Vector3,re=new a.Vector3;return function(){re.set(_.x-y.x,_.y-y.y,0);let Ee=re.length();Ee?(p.copy(e.object.position).sub(e.target),V.copy(p).normalize(),Z.copy(e.object.up).normalize(),oe.crossVectors(Z,V).normalize(),Z.setLength(_.y-y.y),oe.setLength(_.x-y.x),re.copy(Z.add(oe)),S.crossVectors(re,p).normalize(),Ee*=e.rotateSpeed,P.setFromAxisAngle(S,Ee),p.applyQuaternion(P),e.object.up.applyQuaternion(P),E.copy(S),m=Ee):!e.staticMoving&&m&&(m*=Math.sqrt(1-e.dynamicDampingFactor),p.copy(e.object.position).sub(e.target),P.setFromAxisAngle(E,m),p.applyQuaternion(P),e.object.up.applyQuaternion(P)),y.copy(_)}}(),this.zoomCamera=function(){let S;l===o.TOUCH_ZOOM_PAN?(S=h/f,h=f,e.object.isPerspectiveCamera?p.multiplyScalar(S):e.object.isOrthographicCamera?(e.object.zoom/=S,e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(S=1+(b.y-w.y)*e.zoomSpeed,S!==1&&S>0&&(e.object.isPerspectiveCamera?p.multiplyScalar(S):e.object.isOrthographicCamera?(e.object.zoom/=S,e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?w.copy(b):w.y+=(b.y-w.y)*this.dynamicDampingFactor)},this.panCamera=function(){const S=new a.Vector2,P=new a.Vector3,V=new a.Vector3;return function(){if(S.copy(A).sub(T),S.lengthSq()){if(e.object.isOrthographicCamera){const oe=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,re=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;S.x*=oe,S.y*=re}S.multiplyScalar(p.length()*e.panSpeed),V.copy(p).cross(e.object.up).setLength(S.x),V.add(P.copy(e.object.up).setLength(S.y)),e.object.position.add(V),e.target.add(V),e.staticMoving?T.copy(A):T.add(S.subVectors(A,T).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(p.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,p.setLength(e.maxDistance)),w.copy(b)),p.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,p.setLength(e.minDistance)),w.copy(b)))},this.update=function(){p.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,p),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),s.distanceToSquared(e.object.position)>i&&(e.dispatchEvent(ot),s.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(s.distanceToSquared(e.object.position)>i||r!==e.object.zoom)&&(e.dispatchEvent(ot),s.copy(e.object.position),r=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){l=o.NONE,u=o.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),p.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent(ot),s.copy(e.object.position),r=e.object.zoom};function z(S){e.enabled!==!1&&(x.length===0&&(e.domElement.setPointerCapture(S.pointerId),e.domElement.addEventListener("pointermove",j),e.domElement.addEventListener("pointerup",B)),Ge(S),S.pointerType==="touch"?$(S):H(S))}function j(S){e.enabled!==!1&&(S.pointerType==="touch"?me(S):ne(S))}function B(S){e.enabled!==!1&&(S.pointerType==="touch"?ge(S):Y(),ye(S),x.length===0&&(e.domElement.releasePointerCapture(S.pointerId),e.domElement.removeEventListener("pointermove",j),e.domElement.removeEventListener("pointerup",B)))}function W(S){ye(S)}function N(S){e.enabled!==!1&&(window.removeEventListener("keydown",N),u===o.NONE&&(S.code===e.keys[o.ROTATE]&&!e.noRotate?u=o.ROTATE:S.code===e.keys[o.ZOOM]&&!e.noZoom?u=o.ZOOM:S.code===e.keys[o.PAN]&&!e.noPan&&(u=o.PAN)))}function U(){e.enabled!==!1&&(u=o.NONE,window.addEventListener("keydown",N))}function H(S){if(l===o.NONE)switch(S.button){case e.mouseButtons.LEFT:l=o.ROTATE;break;case e.mouseButtons.MIDDLE:l=o.ZOOM;break;case e.mouseButtons.RIGHT:l=o.PAN;break}const P=u!==o.NONE?u:l;P===o.ROTATE&&!e.noRotate?(_.copy(k(S.pageX,S.pageY)),y.copy(_)):P===o.ZOOM&&!e.noZoom?(w.copy(D(S.pageX,S.pageY)),b.copy(w)):P===o.PAN&&!e.noPan&&(T.copy(D(S.pageX,S.pageY)),A.copy(T)),e.dispatchEvent(st)}function ne(S){const P=u!==o.NONE?u:l;P===o.ROTATE&&!e.noRotate?(y.copy(_),_.copy(k(S.pageX,S.pageY))):P===o.ZOOM&&!e.noZoom?b.copy(D(S.pageX,S.pageY)):P===o.PAN&&!e.noPan&&A.copy(D(S.pageX,S.pageY))}function Y(){l=o.NONE,e.dispatchEvent(it)}function J(S){if(e.enabled!==!1&&e.noZoom!==!0){switch(S.preventDefault(),S.deltaMode){case 2:w.y-=S.deltaY*.025;break;case 1:w.y-=S.deltaY*.01;break;default:w.y-=S.deltaY*25e-5;break}e.dispatchEvent(st),e.dispatchEvent(it)}}function $(S){switch(He(S),x.length){case 1:l=o.TOUCH_ROTATE,_.copy(k(x[0].pageX,x[0].pageY)),y.copy(_);break;default:l=o.TOUCH_ZOOM_PAN;const P=x[0].pageX-x[1].pageX,V=x[0].pageY-x[1].pageY;f=h=Math.sqrt(P*P+V*V);const Z=(x[0].pageX+x[1].pageX)/2,oe=(x[0].pageY+x[1].pageY)/2;T.copy(D(Z,oe)),A.copy(T);break}e.dispatchEvent(st)}function me(S){switch(He(S),x.length){case 1:y.copy(_),_.copy(k(S.pageX,S.pageY));break;default:const P=Qe(S),V=S.pageX-P.x,Z=S.pageY-P.y;f=Math.sqrt(V*V+Z*Z);const oe=(S.pageX+P.x)/2,re=(S.pageY+P.y)/2;A.copy(D(oe,re));break}}function ge(S){switch(x.length){case 0:l=o.NONE;break;case 1:l=o.TOUCH_ROTATE,_.copy(k(S.pageX,S.pageY)),y.copy(_);break;case 2:l=o.TOUCH_ZOOM_PAN,_.copy(k(S.pageX-y.x,S.pageY-y.y)),y.copy(_);break}e.dispatchEvent(it)}function ue(S){e.enabled!==!1&&S.preventDefault()}function Ge(S){x.push(S)}function ye(S){delete O[S.pointerId];for(let P=0;P<x.length;P++)if(x[P].pointerId==S.pointerId){x.splice(P,1);return}}function He(S){let P=O[S.pointerId];P===void 0&&(P=new a.Vector2,O[S.pointerId]=P),P.set(S.pageX,S.pageY)}function Qe(S){const P=S.pointerId===x[0].pointerId?x[1]:x[0];return O[P.pointerId]}this.dispose=function(){e.domElement.removeEventListener("contextmenu",ue),e.domElement.removeEventListener("pointerdown",z),e.domElement.removeEventListener("pointercancel",W),e.domElement.removeEventListener("wheel",J),e.domElement.removeEventListener("pointermove",j),e.domElement.removeEventListener("pointerup",B),window.removeEventListener("keydown",N),window.removeEventListener("keyup",U)},this.domElement.addEventListener("contextmenu",ue),this.domElement.addEventListener("pointerdown",z),this.domElement.addEventListener("pointercancel",W),this.domElement.addEventListener("wheel",J,{passive:!1}),window.addEventListener("keydown",N),window.addEventListener("keyup",U),this.handleResize(),this.update()}}const Mo={name:"TrackballControls",render:()=>null},It=d.defineComponent({...Mo,props:{minDistance:{default:0},maxDistance:{default:1/0},panSpeed:{default:.3},rotateSpeed:{default:1},zoomSpeed:{default:1.2}},setup(c,{expose:n}){const t=c,e=d.ref(null);d.inject("addControls")(e);const o=d.inject("parentCamera"),i=d.inject("canvas");function s(){e.value!=null&&(e.value.rotateSpeed=t.rotateSpeed,e.value.zoomSpeed=t.zoomSpeed,e.value.panSpeed=t.panSpeed,e.value.minDistance=t.minDistance,e.value.maxDistance=t.maxDistance)}let r=!1;const l=()=>{if(!i.value||r)return;e.value=new wo(o,i.value),new ResizeObserver(h=>{h.forEach(f=>{var m;(m=e.value)==null||m.handleResize()})}).observe(i.value),s(),r=!0};return d.watch(i,()=>{l()}),s(),M(t,"panSpeed",s),M(t,"rotateSpeed",s),M(t,"zoomSpeed",s),M(t,"minDistance",s),M(t,"maxDistance",s),n({three:e}),{props:t,three:e,camera:o,canvas:i,applyProps:s,get boundCamera(){return r},set boundCamera(u){r=u},tryBindCamera:l}}}),we=new a.Raycaster,Q=new a.Vector3,he=new a.Vector3,F=new a.Quaternion,kt={X:new a.Vector3(1,0,0),Y:new a.Vector3(0,1,0),Z:new a.Vector3(0,0,1)},at={type:"change"},jt={type:"mouseDown"},Dt={type:"mouseUp",mode:null},Gt={type:"objectChange"};class bo extends a.Object3D{constructor(n,t){super(),t===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const e=new Co;this._gizmo=e,this.add(e);const o=new Lo;this._plane=o,this.add(o);const i=this;function s(b,T){let A=T;Object.defineProperty(i,b,{get:function(){return A!==void 0?A:T},set:function(x){A!==x&&(A=x,o[b]=x,e[b]=x,i.dispatchEvent({type:b+"-changed",value:x}),i.dispatchEvent(at))}}),i[b]=T,o[b]=T,e[b]=T}s("camera",n),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);const r=new a.Vector3,l=new a.Vector3,u=new a.Quaternion,h=new a.Quaternion,f=new a.Vector3,m=new a.Quaternion,p=new a.Vector3,y=new a.Vector3,_=new a.Vector3,E=0,w=new a.Vector3;s("worldPosition",r),s("worldPositionStart",l),s("worldQuaternion",u),s("worldQuaternionStart",h),s("cameraPosition",f),s("cameraQuaternion",m),s("pointStart",p),s("pointEnd",y),s("rotationAxis",_),s("rotationAngle",E),s("eye",w),this._offset=new a.Vector3,this._startNorm=new a.Vector3,this._endNorm=new a.Vector3,this._cameraScale=new a.Vector3,this._parentPosition=new a.Vector3,this._parentQuaternion=new a.Quaternion,this._parentQuaternionInv=new a.Quaternion,this._parentScale=new a.Vector3,this._worldScaleStart=new a.Vector3,this._worldQuaternionInv=new a.Quaternion,this._worldScale=new a.Vector3,this._positionStart=new a.Vector3,this._quaternionStart=new a.Quaternion,this._scaleStart=new a.Vector3,this._getPointer=Eo.bind(this),this._onPointerDown=To.bind(this),this._onPointerHover=So.bind(this),this._onPointerMove=xo.bind(this),this._onPointerUp=Ao.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(n){if(this.object===void 0||this.dragging===!0)return;we.setFromCamera(n,this.camera);const t=rt(this._gizmo.picker[this.mode],we);t?this.axis=t.object.name:this.axis=null}pointerDown(n){if(!(this.object===void 0||this.dragging===!0||n.button!==0)&&this.axis!==null){we.setFromCamera(n,this.camera);const t=rt(this._plane,we,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,jt.mode=this.mode,this.dispatchEvent(jt)}}pointerMove(n){const t=this.axis,e=this.mode,o=this.object;let i=this.space;if(e==="scale"?i="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(i="world"),o===void 0||t===null||this.dragging===!1||n.button!==-1)return;we.setFromCamera(n,this.camera);const s=rt(this._plane,we,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),e==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),i==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),i==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),o.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(i==="local"&&(o.position.applyQuaternion(F.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(this._quaternionStart)),i==="world"&&(o.parent&&o.position.add(Q.setFromMatrixPosition(o.parent.matrixWorld)),t.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(Q.setFromMatrixPosition(o.parent.matrixWorld))));else if(e==="scale"){if(t.search("XYZ")!==-1){let r=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(r*=-1),he.set(r,r,r)}else Q.copy(this.pointStart),he.copy(this.pointEnd),Q.applyQuaternion(this._worldQuaternionInv),he.applyQuaternion(this._worldQuaternionInv),he.divide(Q),t.search("X")===-1&&(he.x=1),t.search("Y")===-1&&(he.y=1),t.search("Z")===-1&&(he.z=1);o.scale.copy(this._scaleStart).multiply(he),this.scaleSnap&&(t.search("X")!==-1&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(e==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const r=20/this.worldPosition.distanceTo(Q.setFromMatrixPosition(this.camera.matrixWorld));t==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Q.copy(this.rotationAxis).cross(this.eye))*r):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(kt[t]),Q.copy(kt[t]),i==="local"&&Q.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Q.cross(this.eye).normalize())*r),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),i==="local"&&t!=="E"&&t!=="XYZE"?(o.quaternion.copy(this._quaternionStart),o.quaternion.multiply(F.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),o.quaternion.copy(F.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),o.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(at),this.dispatchEvent(Gt)}}pointerUp(n){n.button===0&&(this.dragging&&this.axis!==null&&(Dt.mode=this.mode,this.dispatchEvent(Dt)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(n){n.geometry&&n.geometry.dispose(),n.material&&n.material.dispose()})}attach(n){return this.object=n,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(at),this.dispatchEvent(Gt),this.pointStart.copy(this.pointEnd))}getRaycaster(){return we}getMode(){return this.mode}setMode(n){this.mode=n}setTranslationSnap(n){this.translationSnap=n}setRotationSnap(n){this.rotationSnap=n}setScaleSnap(n){this.scaleSnap=n}setSize(n){this.size=n}setSpace(n){this.space=n}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function Eo(c){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:c.button};{const n=this.domElement.getBoundingClientRect();return{x:(c.clientX-n.left)/n.width*2-1,y:-(c.clientY-n.top)/n.height*2+1,button:c.button}}}function So(c){if(this.enabled)switch(c.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(c));break}}function To(c){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(c.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(c)),this.pointerDown(this._getPointer(c)))}function xo(c){this.enabled&&this.pointerMove(this._getPointer(c))}function Ao(c){this.enabled&&(this.domElement.releasePointerCapture(c.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(c)))}function rt(c,n,t){const e=n.intersectObject(c,!0);for(let o=0;o<e.length;o++)if(e[o].object.visible||t)return e[o];return!1}const $e=new a.Euler,G=new a.Vector3(0,1,0),Ht=new a.Vector3(0,0,0),Ft=new a.Matrix4,Xe=new a.Quaternion,Ye=new a.Quaternion,ae=new a.Vector3,Nt=new a.Matrix4,Pe=new a.Vector3(1,0,0),Me=new a.Vector3(0,1,0),ve=new a.Vector3(0,0,1),Ze=new a.Vector3,Oe=new a.Vector3,Ie=new a.Vector3;class Co extends a.Object3D{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const n=new a.MeshBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new a.LineBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=n.clone();e.opacity=.15;const o=t.clone();o.opacity=.5;const i=n.clone();i.color.setHex(16711680);const s=n.clone();s.color.setHex(65280);const r=n.clone();r.color.setHex(255);const l=n.clone();l.color.setHex(16711680),l.opacity=.5;const u=n.clone();u.color.setHex(65280),u.opacity=.5;const h=n.clone();h.color.setHex(255),h.opacity=.5;const f=n.clone();f.opacity=.25;const m=n.clone();m.color.setHex(16776960),m.opacity=.25,n.clone().color.setHex(16776960);const y=n.clone();y.color.setHex(7895160);const _=new a.CylinderGeometry(0,.04,.1,12);_.translate(0,.05,0);const E=new a.BoxGeometry(.08,.08,.08);E.translate(0,.04,0);const w=new a.BufferGeometry;w.setAttribute("position",new a.Float32BufferAttribute([0,0,0,1,0,0],3));const b=new a.CylinderGeometry(.0075,.0075,.5,3);b.translate(0,.25,0);function T(H,ne){const Y=new a.TorusGeometry(H,.0075,3,64,ne*Math.PI*2);return Y.rotateY(Math.PI/2),Y.rotateX(Math.PI/2),Y}function A(){const H=new a.BufferGeometry;return H.setAttribute("position",new a.Float32BufferAttribute([0,0,0,1,1,1],3)),H}const x={X:[[new a.Mesh(_,i),[.5,0,0],[0,0,-Math.PI/2]],[new a.Mesh(_,i),[-.5,0,0],[0,0,Math.PI/2]],[new a.Mesh(b,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new a.Mesh(_,s),[0,.5,0]],[new a.Mesh(_,s),[0,-.5,0],[Math.PI,0,0]],[new a.Mesh(b,s)]],Z:[[new a.Mesh(_,r),[0,0,.5],[Math.PI/2,0,0]],[new a.Mesh(_,r),[0,0,-.5],[-Math.PI/2,0,0]],[new a.Mesh(b,r),null,[Math.PI/2,0,0]]],XYZ:[[new a.Mesh(new a.OctahedronGeometry(.1,0),f.clone()),[0,0,0]]],XY:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},O={X:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[.3,0,0],[0,0,-Math.PI/2]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,.3,0]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,-.3,0],[0,0,Math.PI]]],Z:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,0,.3],[Math.PI/2,0,0]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new a.Mesh(new a.OctahedronGeometry(.2,0),e)]],XY:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[.15,.15,0]]],YZ:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[.15,0,.15],[-Math.PI/2,0,0]]]},D={START:[[new a.Mesh(new a.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],END:[[new a.Mesh(new a.OctahedronGeometry(.01,2),o),null,null,null,"helper"]],DELTA:[[new a.Line(A(),o),null,null,null,"helper"]],X:[[new a.Line(w,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new a.Line(w,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new a.Line(w,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},k={XYZE:[[new a.Mesh(T(.5,1),y),null,[0,Math.PI/2,0]]],X:[[new a.Mesh(T(.5,.5),i)]],Y:[[new a.Mesh(T(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new a.Mesh(T(.5,.5),r),null,[0,Math.PI/2,0]]],E:[[new a.Mesh(T(.75,1),m),null,[0,Math.PI/2,0]]]},z={AXIS:[[new a.Line(w,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},j={XYZE:[[new a.Mesh(new a.SphereGeometry(.25,10,8),e)]],X:[[new a.Mesh(new a.TorusGeometry(.5,.1,4,24),e),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new a.Mesh(new a.TorusGeometry(.5,.1,4,24),e),[0,0,0],[Math.PI/2,0,0]]],Z:[[new a.Mesh(new a.TorusGeometry(.5,.1,4,24),e),[0,0,0],[0,0,-Math.PI/2]]],E:[[new a.Mesh(new a.TorusGeometry(.75,.1,2,24),e)]]},B={X:[[new a.Mesh(E,i),[.5,0,0],[0,0,-Math.PI/2]],[new a.Mesh(b,i),[0,0,0],[0,0,-Math.PI/2]],[new a.Mesh(E,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new a.Mesh(E,s),[0,.5,0]],[new a.Mesh(b,s)],[new a.Mesh(E,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new a.Mesh(E,r),[0,0,.5],[Math.PI/2,0,0]],[new a.Mesh(b,r),[0,0,0],[Math.PI/2,0,0]],[new a.Mesh(E,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a.Mesh(new a.BoxGeometry(.15,.15,.01),u),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new a.Mesh(new a.BoxGeometry(.1,.1,.1),f.clone())]]},W={X:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[.3,0,0],[0,0,-Math.PI/2]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,.3,0]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,-.3,0],[0,0,Math.PI]]],Z:[[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,0,.3],[Math.PI/2,0,0]],[new a.Mesh(new a.CylinderGeometry(.2,0,.6,4),e),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[.15,.15,0]]],YZ:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new a.Mesh(new a.BoxGeometry(.2,.2,.01),e),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new a.Mesh(new a.BoxGeometry(.2,.2,.2),e),[0,0,0]]]},N={X:[[new a.Line(w,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new a.Line(w,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new a.Line(w,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function U(H){const ne=new a.Object3D;for(const Y in H)for(let J=H[Y].length;J--;){const $=H[Y][J][0].clone(),me=H[Y][J][1],ge=H[Y][J][2],ue=H[Y][J][3],Ge=H[Y][J][4];$.name=Y,$.tag=Ge,me&&$.position.set(me[0],me[1],me[2]),ge&&$.rotation.set(ge[0],ge[1],ge[2]),ue&&$.scale.set(ue[0],ue[1],ue[2]),$.updateMatrix();const ye=$.geometry.clone();ye.applyMatrix4($.matrix),$.geometry=ye,$.renderOrder=1/0,$.position.set(0,0,0),$.rotation.set(0,0,0),$.scale.set(1,1,1),ne.add($)}return ne}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=U(x)),this.add(this.gizmo.rotate=U(k)),this.add(this.gizmo.scale=U(B)),this.add(this.picker.translate=U(O)),this.add(this.picker.rotate=U(j)),this.add(this.picker.scale=U(W)),this.add(this.helper.translate=U(D)),this.add(this.helper.rotate=U(z)),this.add(this.helper.scale=U(N)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(n){const e=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Ye;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let o=[];o=o.concat(this.picker[this.mode].children),o=o.concat(this.gizmo[this.mode].children),o=o.concat(this.helper[this.mode].children);for(let i=0;i<o.length;i++){const s=o[i];s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition);let r;if(this.camera.isOrthographicCamera?r=(this.camera.top-this.camera.bottom)/this.camera.zoom:r=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(r*this.size/4),s.tag==="helper"){s.visible=!1,s.name==="AXIS"?(s.position.copy(this.worldPositionStart),s.visible=!!this.axis,this.axis==="X"&&(F.setFromEuler($e.set(0,0,0)),s.quaternion.copy(e).multiply(F),Math.abs(G.copy(Pe).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="Y"&&(F.setFromEuler($e.set(0,0,Math.PI/2)),s.quaternion.copy(e).multiply(F),Math.abs(G.copy(Me).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="Z"&&(F.setFromEuler($e.set(0,Math.PI/2,0)),s.quaternion.copy(e).multiply(F),Math.abs(G.copy(ve).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="XYZE"&&(F.setFromEuler($e.set(0,Math.PI/2,0)),G.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(Ft.lookAt(Ht,G,Me)),s.quaternion.multiply(F),s.visible=this.dragging),this.axis==="E"&&(s.visible=!1)):s.name==="START"?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):s.name==="END"?(s.position.copy(this.worldPosition),s.visible=this.dragging):s.name==="DELTA"?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),Q.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Q.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(Q),s.visible=this.dragging):(s.quaternion.copy(e),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=this.axis.search(s.name)!==-1));continue}s.quaternion.copy(e),this.mode==="translate"||this.mode==="scale"?(s.name==="X"&&Math.abs(G.copy(Pe).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="Y"&&Math.abs(G.copy(Me).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="Z"&&Math.abs(G.copy(ve).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="XY"&&Math.abs(G.copy(ve).applyQuaternion(e).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="YZ"&&Math.abs(G.copy(Pe).applyQuaternion(e).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="XZ"&&Math.abs(G.copy(Me).applyQuaternion(e).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):this.mode==="rotate"&&(Xe.copy(e),G.copy(this.eye).applyQuaternion(F.copy(e).invert()),s.name.search("E")!==-1&&s.quaternion.setFromRotationMatrix(Ft.lookAt(this.eye,Ht,Me)),s.name==="X"&&(F.setFromAxisAngle(Pe,Math.atan2(-G.y,G.z)),F.multiplyQuaternions(Xe,F),s.quaternion.copy(F)),s.name==="Y"&&(F.setFromAxisAngle(Me,Math.atan2(G.x,G.z)),F.multiplyQuaternions(Xe,F),s.quaternion.copy(F)),s.name==="Z"&&(F.setFromAxisAngle(ve,Math.atan2(G.y,G.x)),F.multiplyQuaternions(Xe,F),s.quaternion.copy(F))),s.visible=s.visible&&(s.name.indexOf("X")===-1||this.showX),s.visible=s.visible&&(s.name.indexOf("Y")===-1||this.showY),s.visible=s.visible&&(s.name.indexOf("Z")===-1||this.showZ),s.visible=s.visible&&(s.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis||this.axis.split("").some(function(l){return s.name===l}))&&(s.material.color.setHex(16776960),s.material.opacity=1)}super.updateMatrixWorld(n)}}class Lo extends a.Mesh{constructor(){super(new a.PlaneGeometry(1e5,1e5,2,2),new a.MeshBasicMaterial({visible:!1,wireframe:!0,side:a.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(n){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),Ze.copy(Pe).applyQuaternion(t==="local"?this.worldQuaternion:Ye),Oe.copy(Me).applyQuaternion(t==="local"?this.worldQuaternion:Ye),Ie.copy(ve).applyQuaternion(t==="local"?this.worldQuaternion:Ye),G.copy(Oe),this.mode){case"translate":case"scale":switch(this.axis){case"X":G.copy(this.eye).cross(Ze),ae.copy(Ze).cross(G);break;case"Y":G.copy(this.eye).cross(Oe),ae.copy(Oe).cross(G);break;case"Z":G.copy(this.eye).cross(Ie),ae.copy(Ie).cross(G);break;case"XY":ae.copy(Ie);break;case"YZ":ae.copy(Ze);break;case"XZ":G.copy(Ie),ae.copy(Oe);break;case"XYZ":case"E":ae.set(0,0,0);break}break;case"rotate":default:ae.set(0,0,0)}ae.length()===0?this.quaternion.copy(this.cameraQuaternion):(Nt.lookAt(Q.set(0,0,0),ae,G),this.quaternion.setFromRotationMatrix(Nt)),super.updateMatrixWorld(n)}}const Ro={name:"TransformControls",render:()=>null},Bt=d.defineComponent({...Ro,props:{mode:{default:"translate"},position:null,rotationSnap:{default:null},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0},size:{default:1},translationSnap:{default:null}},setup(c,{expose:n}){const t=c,e=d.shallowRef(null),o=d.inject("scene"),i=d.inject("mesh",null),s=d.inject("parent",void 0),r=d.inject("camera"),l=d.inject("canvas"),u=d.inject("enableAllControls"),h=d.inject("disableAllControls");function f(){e.value!=null&&(e.value.mode=t.mode,e.value.size=t.size,e.value.showX=t.showX,e.value.showY=t.showY,e.value.showZ=t.showZ,e.value.translationSnap=t.translationSnap,e.value.rotationSnap=t.rotationSnap)}let m=!1;const p=()=>{!l.value&&!r.value||m||(e.value=new bo(r.value,l.value),L(t,"position",e.value),i?e.value.attach(i):s&&e.value.attach(s),e.value.addEventListener("dragging-changed",function(y){y.value?h():u()}),o.add(e.value),f(),m=!0)};return d.watch(l,()=>{p()},{immediate:!0}),f(),M(t,"mode",f),M(t,"size",f),M(t,"showX",f),M(t,"showY",f),M(t,"showZ",f),M(t,"rotationSnap",f),M(t,"translationSnap",f),d.onUnmounted(()=>{o.remove(e.value),ie(e.value)}),n({three:e}),{props:t,three:e,scene:o,mesh:i,parent:s,camera:r,canvas:l,enableAllControls:u,disableAllControls:h,applyProps:f,get boundCamera(){return m},set boundCamera(y){m=y},tryBindCamera:p}}}),Ut=d.defineComponent({__name:"Group",props:{enableRaycasting:{type:Boolean,default:!1},onClick:{type:Function,default:()=>null},onMouseMove:{type:Function,default:()=>null},onMouseEnter:{type:Function,default:()=>null},onMouseLeave:{type:Function,default:()=>null},position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=new a.Group;return K(e),L(t,"position",e),L(t,"rotation",e),L(t,"scale",e),Je(e.children,t),d.provide("parent",e),n({three:e}),(o,i)=>d.renderSlot(o.$slots,"default")}}),Vt=d.defineComponent({__name:"InstancedMesh",props:{castShadow:{type:Boolean,default:!1},count:null,geometry:{default:null},material:{default:null},receiveShadow:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.MeshBasicMaterial,s=new a.InstancedMesh(o,i,t.count);s.castShadow=!0,s.receiveShadow=!0,K(s);function r(){s.castShadow=t.castShadow,s.receiveShadow=t.receiveShadow}r(),M(t,"castShadow",r),M(t,"receiveShadow",r);const l=d.inject("getGeometry"),u=d.inject("getMaterial");return d.onMounted(()=>{if(t.geometry){const h=l(t.geometry);s.geometry=h}if(t.material){const h=u(t.material);s.material=h}}),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(h,f)=>d.renderSlot(h.$slots,"default")}}),zt=d.defineComponent({__name:"Line",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.LineBasicMaterial({color:"black"}),s=new a.Line(o,i);return K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(r,l)=>d.renderSlot(r.$slots,"default")}}),$t=d.defineComponent({__name:"LineLoop",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.LineBasicMaterial({color:"black"}),s=new a.LineLoop(o,i);return K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(r,l)=>d.renderSlot(r.$slots,"default")}}),Xt=d.defineComponent({__name:"LineSegments",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.LineBasicMaterial({color:"black"}),s=new a.LineSegments(o,i);return K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(r,l)=>d.renderSlot(r.$slots,"default")}}),Yt=d.defineComponent({__name:"Mesh",props:{castShadow:{type:Boolean,default:!1},geometry:{default:null},material:{default:null},name:{default:""},position:{default:()=>[0,0,0]},receiveShadow:{type:Boolean,default:!1},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.MeshBasicMaterial,s=new a.Mesh(o,i);s.castShadow=!0,s.receiveShadow=!0,K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s),M(t,"position",()=>{I.object3DTranslated(t.name,s)}),M(t,"rotation",()=>{I.object3DTranslated(t.name,s)}),M(t,"scale",()=>{I.object3DTranslated(t.name,s)});function r(){s.name=t.name,s.castShadow=t.castShadow,s.receiveShadow=t.receiveShadow}r(),M(t,"castShadow",r),M(t,"receiveShadow",r);const l=d.inject("getGeometry"),u=d.inject("getMaterial");return d.onMounted(()=>{if(t.geometry){const h=l(t.geometry);s.geometry=h}if(t.material){const h=u(t.material);s.material=h}I.object3DChanged(t.name,s)}),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(h,f)=>d.renderSlot(h.$slots,"default")}}),Zt=d.defineComponent({__name:"Points",props:{name:{default:""},position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.PointsMaterial({color:"red",sizeAttenuation:!1,size:2}),s=new a.Points(o,i);K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s),M(t,"position",()=>{I.object3DTranslated(t.name,s)}),M(t,"rotation",()=>{I.object3DTranslated(t.name,s)}),M(t,"scale",()=>{I.object3DTranslated(t.name,s)});function r(){s.name=t.name}return r(),d.onMounted(()=>{I.object3DChanged(t.name,s)}),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(l,u)=>d.renderSlot(l.$slots,"default")}});class Po extends a.Loader{constructor(n){super(n),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new jo(t)}),this.register(function(t){return new Uo(t)}),this.register(function(t){return new Vo(t)}),this.register(function(t){return new Go(t)}),this.register(function(t){return new Ho(t)}),this.register(function(t){return new Fo(t)}),this.register(function(t){return new No(t)}),this.register(function(t){return new ko(t)}),this.register(function(t){return new Bo(t)}),this.register(function(t){return new Do(t)}),this.register(function(t){return new Oo(t)}),this.register(function(t){return new zo(t)})}load(n,t,e,o){const i=this;let s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=a.LoaderUtils.extractUrlBase(n),this.manager.itemStart(n);const r=function(u){o?o(u):console.error(u),i.manager.itemError(n),i.manager.itemEnd(n)},l=new a.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(n,function(u){try{i.parse(u,s,function(h){t(h),i.manager.itemEnd(n)},r)}catch(h){r(h)}},e,r)}setDRACOLoader(n){return this.dracoLoader=n,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(n){return this.ktx2Loader=n,this}setMeshoptDecoder(n){return this.meshoptDecoder=n,this}register(n){return this.pluginCallbacks.indexOf(n)===-1&&this.pluginCallbacks.push(n),this}unregister(n){return this.pluginCallbacks.indexOf(n)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(n),1),this}parse(n,t,e,o){let i;const s={},r={};if(typeof n=="string")i=n;else if(a.LoaderUtils.decodeText(new Uint8Array(n,0,4))===qt){try{s[v.KHR_BINARY_GLTF]=new $o(n)}catch(f){o&&o(f);return}i=s[v.KHR_BINARY_GLTF].content}else i=a.LoaderUtils.decodeText(new Uint8Array(n));const l=JSON.parse(i);if(l.asset===void 0||l.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new ss(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const f=this.pluginCallbacks[h](u);r[f.name]=f,s[f.name]=!0}if(l.extensionsUsed)for(let h=0;h<l.extensionsUsed.length;++h){const f=l.extensionsUsed[h],m=l.extensionsRequired||[];switch(f){case v.KHR_MATERIALS_UNLIT:s[f]=new Io;break;case v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[f]=new Zo;break;case v.KHR_DRACO_MESH_COMPRESSION:s[f]=new Xo(l,this.dracoLoader);break;case v.KHR_TEXTURE_TRANSFORM:s[f]=new Yo;break;case v.KHR_MESH_QUANTIZATION:s[f]=new qo;break;default:m.indexOf(f)>=0&&r[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(s),u.setPlugins(r),u.parse(e,o)}parseAsync(n,t){const e=this;return new Promise(function(o,i){e.parse(n,t,o,i)})}}function vo(){let c={};return{get:function(n){return c[n]},add:function(n,t){c[n]=t},remove:function(n){delete c[n]},removeAll:function(){c={}}}}const v={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class Oo{constructor(n){this.parser=n,this.name=v.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const n=this.parser,t=this.parser.json.nodes||[];for(let e=0,o=t.length;e<o;e++){const i=t[e];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&n._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(n){const t=this.parser,e="light:"+n;let o=t.cache.get(e);if(o)return o;const i=t.json,l=((i.extensions&&i.extensions[this.name]||{}).lights||[])[n];let u;const h=new a.Color(16777215);l.color!==void 0&&h.fromArray(l.color);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new a.DirectionalLight(h),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new a.PointLight(h),u.distance=f;break;case"spot":u=new a.SpotLight(h),u.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+n),o=Promise.resolve(u),t.cache.add(e,o),o}createNodeAttachment(n){const t=this,e=this.parser,i=e.json.nodes[n],r=(i.extensions&&i.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(l){return e._getNodeRef(t.cache,r,l)})}}class Io{constructor(){this.name=v.KHR_MATERIALS_UNLIT}getMaterialType(){return a.MeshBasicMaterial}extendParams(n,t,e){const o=[];n.color=new a.Color(1,1,1),n.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const s=i.baseColorFactor;n.color.fromArray(s),n.opacity=s[3]}i.baseColorTexture!==void 0&&o.push(e.assignTexture(n,"map",i.baseColorTexture,a.sRGBEncoding))}return Promise.all(o)}}class ko{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(n,t){const o=this.parser.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=o.extensions[this.name].emissiveStrength;return i!==void 0&&(t.emissiveIntensity=i),Promise.resolve()}}class jo{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_CLEARCOAT}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&i.push(e.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&i.push(e.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(i.push(e.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const r=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new a.Vector2(r,r)}return Promise.all(i)}}class Do{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_IRIDESCENCE}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&i.push(e.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&i.push(e.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(i)}}class Go{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_SHEEN}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new a.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=o.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&i.push(e.assignTexture(t,"sheenColorMap",s.sheenColorTexture,a.sRGBEncoding)),s.sheenRoughnessTexture!==void 0&&i.push(e.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(i)}}class Ho{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_TRANSMISSION}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&i.push(e.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(i)}}class Fo{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_VOLUME}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&i.push(e.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||0;const r=s.attenuationColor||[1,1,1];return t.attenuationColor=new a.Color(r[0],r[1],r[2]),Promise.all(i)}}class No{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_IOR}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const o=this.parser.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=o.extensions[this.name];return t.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class Bo{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_SPECULAR}getMaterialType(n){const e=this.parser.json.materials[n];return!e.extensions||!e.extensions[this.name]?null:a.MeshPhysicalMaterial}extendMaterialParams(n,t){const e=this.parser,o=e.json.materials[n];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&i.push(e.assignTexture(t,"specularIntensityMap",s.specularTexture));const r=s.specularColorFactor||[1,1,1];return t.specularColor=new a.Color(r[0],r[1],r[2]),s.specularColorTexture!==void 0&&i.push(e.assignTexture(t,"specularColorMap",s.specularColorTexture,a.sRGBEncoding)),Promise.all(i)}}class Uo{constructor(n){this.parser=n,this.name=v.KHR_TEXTURE_BASISU}loadTexture(n){const t=this.parser,e=t.json,o=e.textures[n];if(!o.extensions||!o.extensions[this.name])return null;const i=o.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(n,i.source,s)}}class Vo{constructor(n){this.parser=n,this.name=v.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(n){const t=this.name,e=this.parser,o=e.json,i=o.textures[n];if(!i.extensions||!i.extensions[t])return null;const s=i.extensions[t],r=o.images[s.source];let l=e.textureLoader;if(r.uri){const u=e.options.manager.getHandler(r.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return e.loadTextureImage(n,s.source,l);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return e.loadTexture(n)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(n){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){n(t.height===1)}})),this.isSupported}}class zo{constructor(n){this.name=v.EXT_MESHOPT_COMPRESSION,this.parser=n}loadBufferView(n){const t=this.parser.json,e=t.bufferViews[n];if(e.extensions&&e.extensions[this.name]){const o=e.extensions[this.name],i=this.parser.getDependency("buffer",o.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,s.ready]).then(function(r){const l=o.byteOffset||0,u=o.byteLength||0,h=o.count,f=o.byteStride,m=new ArrayBuffer(h*f),p=new Uint8Array(r[0],l,u);return s.decodeGltfBuffer(new Uint8Array(m),h,f,p,o.mode,o.filter),m})}else return null}}const qt="glTF",ke=12,Kt={JSON:1313821514,BIN:5130562};class $o{constructor(n){this.name=v.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(n,0,ke);if(this.header={magic:a.LoaderUtils.decodeText(new Uint8Array(n.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==qt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const e=this.header.length-ke,o=new DataView(n,ke);let i=0;for(;i<e;){const s=o.getUint32(i,!0);i+=4;const r=o.getUint32(i,!0);if(i+=4,r===Kt.JSON){const l=new Uint8Array(n,ke+i,s);this.content=a.LoaderUtils.decodeText(l)}else if(r===Kt.BIN){const l=ke+i;this.body=n.slice(l,l+s)}i+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Xo{constructor(n,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=v.KHR_DRACO_MESH_COMPRESSION,this.json=n,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(n,t){const e=this.json,o=this.dracoLoader,i=n.extensions[this.name].bufferView,s=n.extensions[this.name].attributes,r={},l={},u={};for(const h in s){const f=ut[h]||h.toLowerCase();r[f]=s[h]}for(const h in n.attributes){const f=ut[h]||h.toLowerCase();if(s[h]!==void 0){const m=e.accessors[n.attributes[h]],p=je[m.componentType];u[f]=p,l[f]=m.normalized===!0}}return t.getDependency("bufferView",i).then(function(h){return new Promise(function(f){o.decodeDracoFile(h,function(m){for(const p in m.attributes){const y=m.attributes[p],_=l[p];_!==void 0&&(y.normalized=_)}f(m)},r,u)})})}}class Yo{constructor(){this.name=v.KHR_TEXTURE_TRANSFORM}extendTexture(n,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(n=n.clone(),t.offset!==void 0&&n.offset.fromArray(t.offset),t.rotation!==void 0&&(n.rotation=t.rotation),t.scale!==void 0&&n.repeat.fromArray(t.scale),n.needsUpdate=!0),n}}class ct extends a.MeshStandardMaterial{constructor(n){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),e=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),r={specular:{value:new a.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=r,this.onBeforeCompile=function(l){for(const u in r)l.uniforms[u]=r[u];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",e).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return r.specular.value},set:function(l){r.specular.value=l}},specularMap:{get:function(){return r.specularMap.value},set:function(l){r.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return r.glossiness.value},set:function(l){r.glossiness.value=l}},glossinessMap:{get:function(){return r.glossinessMap.value},set:function(l){r.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(n)}copy(n){return super.copy(n),this.specularMap=n.specularMap,this.specular.copy(n.specular),this.glossinessMap=n.glossinessMap,this.glossiness=n.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Zo{constructor(){this.name=v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return ct}extendParams(n,t,e){const o=t.extensions[this.name];n.color=new a.Color(1,1,1),n.opacity=1;const i=[];if(Array.isArray(o.diffuseFactor)){const s=o.diffuseFactor;n.color.fromArray(s),n.opacity=s[3]}if(o.diffuseTexture!==void 0&&i.push(e.assignTexture(n,"map",o.diffuseTexture,a.sRGBEncoding)),n.emissive=new a.Color(0,0,0),n.glossiness=o.glossinessFactor!==void 0?o.glossinessFactor:1,n.specular=new a.Color(1,1,1),Array.isArray(o.specularFactor)&&n.specular.fromArray(o.specularFactor),o.specularGlossinessTexture!==void 0){const s=o.specularGlossinessTexture;i.push(e.assignTexture(n,"glossinessMap",s)),i.push(e.assignTexture(n,"specularMap",s,a.sRGBEncoding))}return Promise.all(i)}createMaterial(n){const t=new ct(n);return t.fog=!0,t.color=n.color,t.map=n.map===void 0?null:n.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=n.aoMap===void 0?null:n.aoMap,t.aoMapIntensity=1,t.emissive=n.emissive,t.emissiveIntensity=n.emissiveIntensity===void 0?1:n.emissiveIntensity,t.emissiveMap=n.emissiveMap===void 0?null:n.emissiveMap,t.bumpMap=n.bumpMap===void 0?null:n.bumpMap,t.bumpScale=1,t.normalMap=n.normalMap===void 0?null:n.normalMap,t.normalMapType=a.TangentSpaceNormalMap,n.normalScale&&(t.normalScale=n.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=n.specularMap===void 0?null:n.specularMap,t.specular=n.specular,t.glossinessMap=n.glossinessMap===void 0?null:n.glossinessMap,t.glossiness=n.glossiness,t.alphaMap=null,t.envMap=n.envMap===void 0?null:n.envMap,t.envMapIntensity=1,t}}class qo{constructor(){this.name=v.KHR_MESH_QUANTIZATION}}class lt extends a.Interpolant{constructor(n,t,e,o){super(n,t,e,o)}copySampleValue_(n){const t=this.resultBuffer,e=this.sampleValues,o=this.valueSize,i=n*o*3+o;for(let s=0;s!==o;s++)t[s]=e[i+s];return t}}lt.prototype.interpolate_=function(c,n,t,e){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=s*2,l=s*3,u=e-n,h=(t-n)/u,f=h*h,m=f*h,p=c*l,y=p-l,_=-2*m+3*f,E=m-f,w=1-_,b=E-f+h;for(let T=0;T!==s;T++){const A=i[y+T+s],x=i[y+T+r]*u,O=i[p+T+s],D=i[p+T]*u;o[T]=w*A+b*x+_*O+E*D}return o};const Ko=new a.Quaternion;class Qo extends lt{interpolate_(n,t,e,o){const i=super.interpolate_(n,t,e,o);return Ko.fromArray(i).normalize().toArray(i),i}}const le={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},je={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Qt={9728:a.NearestFilter,9729:a.LinearFilter,9984:a.NearestMipmapNearestFilter,9985:a.LinearMipmapNearestFilter,9986:a.NearestMipmapLinearFilter,9987:a.LinearMipmapLinearFilter},Wt={33071:a.ClampToEdgeWrapping,33648:a.MirroredRepeatWrapping,10497:a.RepeatWrapping},Jt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ut={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},pe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Wo={CUBICSPLINE:void 0,LINEAR:a.InterpolateLinear,STEP:a.InterpolateDiscrete},dt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Jo(c){return c.DefaultMaterial===void 0&&(c.DefaultMaterial=new a.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:a.FrontSide})),c.DefaultMaterial}function De(c,n,t){for(const e in t.extensions)c[e]===void 0&&(n.userData.gltfExtensions=n.userData.gltfExtensions||{},n.userData.gltfExtensions[e]=t.extensions[e])}function be(c,n){n.extras!==void 0&&(typeof n.extras=="object"?Object.assign(c.userData,n.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+n.extras))}function es(c,n,t){let e=!1,o=!1,i=!1;for(let u=0,h=n.length;u<h;u++){const f=n[u];if(f.POSITION!==void 0&&(e=!0),f.NORMAL!==void 0&&(o=!0),f.COLOR_0!==void 0&&(i=!0),e&&o&&i)break}if(!e&&!o&&!i)return Promise.resolve(c);const s=[],r=[],l=[];for(let u=0,h=n.length;u<h;u++){const f=n[u];if(e){const m=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):c.attributes.position;s.push(m)}if(o){const m=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):c.attributes.normal;r.push(m)}if(i){const m=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):c.attributes.color;l.push(m)}}return Promise.all([Promise.all(s),Promise.all(r),Promise.all(l)]).then(function(u){const h=u[0],f=u[1],m=u[2];return e&&(c.morphAttributes.position=h),o&&(c.morphAttributes.normal=f),i&&(c.morphAttributes.color=m),c.morphTargetsRelative=!0,c})}function ts(c,n){if(c.updateMorphTargets(),n.weights!==void 0)for(let t=0,e=n.weights.length;t<e;t++)c.morphTargetInfluences[t]=n.weights[t];if(n.extras&&Array.isArray(n.extras.targetNames)){const t=n.extras.targetNames;if(c.morphTargetInfluences.length===t.length){c.morphTargetDictionary={};for(let e=0,o=t.length;e<o;e++)c.morphTargetDictionary[t[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ns(c){const n=c.extensions&&c.extensions[v.KHR_DRACO_MESH_COMPRESSION];let t;return n?t="draco:"+n.bufferView+":"+n.indices+":"+en(n.attributes):t=c.indices+":"+en(c.attributes)+":"+c.mode,t}function en(c){let n="";const t=Object.keys(c).sort();for(let e=0,o=t.length;e<o;e++)n+=t[e]+":"+c[t[e]]+";";return n}function ft(c){switch(c){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function os(c){return c.search(/\.jpe?g($|\?)/i)>0||c.search(/^data\:image\/jpeg/)===0?"image/jpeg":c.search(/\.webp($|\?)/i)>0||c.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}class ss{constructor(n={},t={}){this.json=n,this.extensions={},this.plugins={},this.options=t,this.cache=new vo,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,o=navigator.userAgent.indexOf("Firefox")>-1,i=o?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;typeof createImageBitmap>"u"||e||o&&i<98?this.textureLoader=new a.TextureLoader(this.options.manager):this.textureLoader=new a.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new a.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(n){this.extensions=n}setPlugins(n){this.plugins=n}parse(n,t){const e=this,o=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([e.getDependencies("scene"),e.getDependencies("animation"),e.getDependencies("camera")])}).then(function(s){const r={scene:s[0][o.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:o.asset,parser:e,userData:{}};De(i,r,o),be(r,o),Promise.all(e._invokeAll(function(l){return l.afterRoot&&l.afterRoot(r)})).then(function(){n(r)})}).catch(t)}_markDefs(){const n=this.json.nodes||[],t=this.json.skins||[],e=this.json.meshes||[];for(let o=0,i=t.length;o<i;o++){const s=t[o].joints;for(let r=0,l=s.length;r<l;r++)n[s[r]].isBone=!0}for(let o=0,i=n.length;o<i;o++){const s=n[o];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(e[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(n,t){t!==void 0&&(n.refs[t]===void 0&&(n.refs[t]=n.uses[t]=0),n.refs[t]++)}_getNodeRef(n,t,e){if(n.refs[t]<=1)return e;const o=e.clone(),i=(s,r)=>{const l=this.associations.get(s);l!=null&&this.associations.set(r,l);for(const[u,h]of s.children.entries())i(h,r.children[u])};return i(e,o),o.name+="_instance_"+n.uses[t]++,o}_invokeOne(n){const t=Object.values(this.plugins);t.push(this);for(let e=0;e<t.length;e++){const o=n(t[e]);if(o)return o}return null}_invokeAll(n){const t=Object.values(this.plugins);t.unshift(this);const e=[];for(let o=0;o<t.length;o++){const i=n(t[o]);i&&e.push(i)}return e}getDependency(n,t){const e=n+":"+t;let o=this.cache.get(e);if(!o){switch(n){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(t)});break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(t)});break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(t)});break;case"texture":o=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(t)});break;case"skin":o=this.loadSkin(t);break;case"animation":o=this._invokeOne(function(i){return i.loadAnimation&&i.loadAnimation(t)});break;case"camera":o=this.loadCamera(t);break;default:throw new Error("Unknown type: "+n)}this.cache.add(e,o)}return o}getDependencies(n){let t=this.cache.get(n);if(!t){const e=this,o=this.json[n+(n==="mesh"?"es":"s")]||[];t=Promise.all(o.map(function(i,s){return e.getDependency(n,s)})),this.cache.add(n,t)}return t}loadBuffer(n){const t=this.json.buffers[n],e=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&n===0)return Promise.resolve(this.extensions[v.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(i,s){e.load(a.LoaderUtils.resolveURL(t.uri,o.path),i,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(n){const t=this.json.bufferViews[n];return this.getDependency("buffer",t.buffer).then(function(e){const o=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+o)})}loadAccessor(n){const t=this,e=this.json,o=this.json.accessors[n];if(o.bufferView===void 0&&o.sparse===void 0)return Promise.resolve(null);const i=[];return o.bufferView!==void 0?i.push(this.getDependency("bufferView",o.bufferView)):i.push(null),o.sparse!==void 0&&(i.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(i).then(function(s){const r=s[0],l=Jt[o.type],u=je[o.componentType],h=u.BYTES_PER_ELEMENT,f=h*l,m=o.byteOffset||0,p=o.bufferView!==void 0?e.bufferViews[o.bufferView].byteStride:void 0,y=o.normalized===!0;let _,E;if(p&&p!==f){const w=Math.floor(m/p),b="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+w+":"+o.count;let T=t.cache.get(b);T||(_=new u(r,w*p,o.count*p/h),T=new a.InterleavedBuffer(_,p/h),t.cache.add(b,T)),E=new a.InterleavedBufferAttribute(T,l,m%p/h,y)}else r===null?_=new u(o.count*l):_=new u(r,m,o.count*l),E=new a.BufferAttribute(_,l,y);if(o.sparse!==void 0){const w=Jt.SCALAR,b=je[o.sparse.indices.componentType],T=o.sparse.indices.byteOffset||0,A=o.sparse.values.byteOffset||0,x=new b(s[1],T,o.sparse.count*w),O=new u(s[2],A,o.sparse.count*l);r!==null&&(E=new a.BufferAttribute(E.array.slice(),E.itemSize,E.normalized));for(let D=0,k=x.length;D<k;D++){const z=x[D];if(E.setX(z,O[D*l]),l>=2&&E.setY(z,O[D*l+1]),l>=3&&E.setZ(z,O[D*l+2]),l>=4&&E.setW(z,O[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(n){const t=this.json,e=this.options,i=t.textures[n].source,s=t.images[i];let r=this.textureLoader;if(s.uri){const l=e.manager.getHandler(s.uri);l!==null&&(r=l)}return this.loadTextureImage(n,i,r)}loadTextureImage(n,t,e){const o=this,i=this.json,s=i.textures[n],r=i.images[t],l=(r.uri||r.bufferView)+":"+s.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,e).then(function(h){h.flipY=!1,s.name&&(h.name=s.name);const m=(i.samplers||{})[s.sampler]||{};return h.magFilter=Qt[m.magFilter]||a.LinearFilter,h.minFilter=Qt[m.minFilter]||a.LinearMipmapLinearFilter,h.wrapS=Wt[m.wrapS]||a.RepeatWrapping,h.wrapT=Wt[m.wrapT]||a.RepeatWrapping,o.associations.set(h,{textures:n}),h}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(n,t){const e=this,o=this.json,i=this.options;if(this.sourceCache[n]!==void 0)return this.sourceCache[n].then(f=>f.clone());const s=o.images[n],r=self.URL||self.webkitURL;let l=s.uri||"",u=!1;if(s.bufferView!==void 0)l=e.getDependency("bufferView",s.bufferView).then(function(f){u=!0;const m=new Blob([f],{type:s.mimeType});return l=r.createObjectURL(m),l});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+n+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(f){return new Promise(function(m,p){let y=m;t.isImageBitmapLoader===!0&&(y=function(_){const E=new a.Texture(_);E.needsUpdate=!0,m(E)}),t.load(a.LoaderUtils.resolveURL(f,i.path),y,void 0,p)})}).then(function(f){return u===!0&&r.revokeObjectURL(l),f.userData.mimeType=s.mimeType||os(s.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[n]=h,h}assignTexture(n,t,e,o){const i=this;return this.getDependency("texture",e.index).then(function(s){if(e.texCoord!==void 0&&e.texCoord!=0&&!(t==="aoMap"&&e.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+e.texCoord+" for texture "+t+" not yet supported."),i.extensions[v.KHR_TEXTURE_TRANSFORM]){const r=e.extensions!==void 0?e.extensions[v.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const l=i.associations.get(s);s=i.extensions[v.KHR_TEXTURE_TRANSFORM].extendTexture(s,r),i.associations.set(s,l)}}return o!==void 0&&(s.encoding=o),n[t]=s,s})}assignFinalMaterial(n){const t=n.geometry;let e=n.material;const o=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(n.isPoints){const r="PointsMaterial:"+e.uuid;let l=this.cache.get(r);l||(l=new a.PointsMaterial,a.Material.prototype.copy.call(l,e),l.color.copy(e.color),l.map=e.map,l.sizeAttenuation=!1,this.cache.add(r,l)),e=l}else if(n.isLine){const r="LineBasicMaterial:"+e.uuid;let l=this.cache.get(r);l||(l=new a.LineBasicMaterial,a.Material.prototype.copy.call(l,e),l.color.copy(e.color),this.cache.add(r,l)),e=l}if(o||i||s){let r="ClonedMaterial:"+e.uuid+":";e.isGLTFSpecularGlossinessMaterial&&(r+="specular-glossiness:"),o&&(r+="derivative-tangents:"),i&&(r+="vertex-colors:"),s&&(r+="flat-shading:");let l=this.cache.get(r);l||(l=e.clone(),i&&(l.vertexColors=!0),s&&(l.flatShading=!0),o&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(r,l),this.associations.set(l,this.associations.get(e))),e=l}e.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),n.material=e}getMaterialType(){return a.MeshStandardMaterial}loadMaterial(n){const t=this,e=this.json,o=this.extensions,i=e.materials[n];let s;const r={},l=i.extensions||{},u=[];if(l[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const f=o[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=f.getMaterialType(),u.push(f.extendParams(r,i,t))}else if(l[v.KHR_MATERIALS_UNLIT]){const f=o[v.KHR_MATERIALS_UNLIT];s=f.getMaterialType(),u.push(f.extendParams(r,i,t))}else{const f=i.pbrMetallicRoughness||{};if(r.color=new a.Color(1,1,1),r.opacity=1,Array.isArray(f.baseColorFactor)){const m=f.baseColorFactor;r.color.fromArray(m),r.opacity=m[3]}f.baseColorTexture!==void 0&&u.push(t.assignTexture(r,"map",f.baseColorTexture,a.sRGBEncoding)),r.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,r.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(r,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(r,"roughnessMap",f.metallicRoughnessTexture))),s=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(n)}),u.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(n,r)})))}i.doubleSided===!0&&(r.side=a.DoubleSide);const h=i.alphaMode||dt.OPAQUE;if(h===dt.BLEND?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,h===dt.MASK&&(r.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&s!==a.MeshBasicMaterial&&(u.push(t.assignTexture(r,"normalMap",i.normalTexture)),r.normalScale=new a.Vector2(1,1),i.normalTexture.scale!==void 0)){const f=i.normalTexture.scale;r.normalScale.set(f,f)}return i.occlusionTexture!==void 0&&s!==a.MeshBasicMaterial&&(u.push(t.assignTexture(r,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(r.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&s!==a.MeshBasicMaterial&&(r.emissive=new a.Color().fromArray(i.emissiveFactor)),i.emissiveTexture!==void 0&&s!==a.MeshBasicMaterial&&u.push(t.assignTexture(r,"emissiveMap",i.emissiveTexture,a.sRGBEncoding)),Promise.all(u).then(function(){let f;return s===ct?f=o[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(r):f=new s(r),i.name&&(f.name=i.name),be(f,i),t.associations.set(f,{materials:n}),i.extensions&&De(o,f,i),f})}createUniqueName(n){const t=a.PropertyBinding.sanitizeNodeName(n||"");let e=t;for(let o=1;this.nodeNamesUsed[e];++o)e=t+"_"+o;return this.nodeNamesUsed[e]=!0,e}loadGeometries(n){const t=this,e=this.extensions,o=this.primitiveCache;function i(r){return e[v.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,t).then(function(l){return nn(l,r,t)})}const s=[];for(let r=0,l=n.length;r<l;r++){const u=n[r],h=ns(u),f=o[h];if(f)s.push(f.promise);else{let m;u.extensions&&u.extensions[v.KHR_DRACO_MESH_COMPRESSION]?m=i(u):m=nn(new a.BufferGeometry,u,t),o[h]={primitive:u,promise:m},s.push(m)}}return Promise.all(s)}loadMesh(n){const t=this,e=this.json,o=this.extensions,i=e.meshes[n],s=i.primitives,r=[];for(let l=0,u=s.length;l<u;l++){const h=s[l].material===void 0?Jo(this.cache):this.getDependency("material",s[l].material);r.push(h)}return r.push(t.loadGeometries(s)),Promise.all(r).then(function(l){const u=l.slice(0,l.length-1),h=l[l.length-1],f=[];for(let p=0,y=h.length;p<y;p++){const _=h[p],E=s[p];let w;const b=u[p];if(E.mode===le.TRIANGLES||E.mode===le.TRIANGLE_STRIP||E.mode===le.TRIANGLE_FAN||E.mode===void 0)w=i.isSkinnedMesh===!0?new a.SkinnedMesh(_,b):new a.Mesh(_,b),w.isSkinnedMesh===!0&&!w.geometry.attributes.skinWeight.normalized&&w.normalizeSkinWeights(),E.mode===le.TRIANGLE_STRIP?w.geometry=on(w.geometry,a.TriangleStripDrawMode):E.mode===le.TRIANGLE_FAN&&(w.geometry=on(w.geometry,a.TriangleFanDrawMode));else if(E.mode===le.LINES)w=new a.LineSegments(_,b);else if(E.mode===le.LINE_STRIP)w=new a.Line(_,b);else if(E.mode===le.LINE_LOOP)w=new a.LineLoop(_,b);else if(E.mode===le.POINTS)w=new a.Points(_,b);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(w.geometry.morphAttributes).length>0&&ts(w,i),w.name=t.createUniqueName(i.name||"mesh_"+n),be(w,i),E.extensions&&De(o,w,E),t.assignFinalMaterial(w),f.push(w)}for(let p=0,y=f.length;p<y;p++)t.associations.set(f[p],{meshes:n,primitives:p});if(f.length===1)return f[0];const m=new a.Group;t.associations.set(m,{meshes:n});for(let p=0,y=f.length;p<y;p++)m.add(f[p]);return m})}loadCamera(n){let t;const e=this.json.cameras[n],o=e[e.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return e.type==="perspective"?t=new a.PerspectiveCamera(a.MathUtils.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):e.type==="orthographic"&&(t=new a.OrthographicCamera(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),e.name&&(t.name=this.createUniqueName(e.name)),be(t,e),Promise.resolve(t)}loadSkin(n){const t=this.json.skins[n],e={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(e):this.getDependency("accessor",t.inverseBindMatrices).then(function(o){return e.inverseBindMatrices=o,e})}loadAnimation(n){const e=this.json.animations[n],o=[],i=[],s=[],r=[],l=[];for(let u=0,h=e.channels.length;u<h;u++){const f=e.channels[u],m=e.samplers[f.sampler],p=f.target,y=p.node!==void 0?p.node:p.id,_=e.parameters!==void 0?e.parameters[m.input]:m.input,E=e.parameters!==void 0?e.parameters[m.output]:m.output;o.push(this.getDependency("node",y)),i.push(this.getDependency("accessor",_)),s.push(this.getDependency("accessor",E)),r.push(m),l.push(p)}return Promise.all([Promise.all(o),Promise.all(i),Promise.all(s),Promise.all(r),Promise.all(l)]).then(function(u){const h=u[0],f=u[1],m=u[2],p=u[3],y=u[4],_=[];for(let w=0,b=h.length;w<b;w++){const T=h[w],A=f[w],x=m[w],O=p[w],D=y[w];if(T===void 0)continue;T.updateMatrix(),T.matrixAutoUpdate=!0;let k;switch(pe[D.path]){case pe.weights:k=a.NumberKeyframeTrack;break;case pe.rotation:k=a.QuaternionKeyframeTrack;break;case pe.position:case pe.scale:default:k=a.VectorKeyframeTrack;break}const z=T.name?T.name:T.uuid,j=O.interpolation!==void 0?Wo[O.interpolation]:a.InterpolateLinear,B=[];pe[D.path]===pe.weights?T.traverse(function(N){N.morphTargetInfluences&&B.push(N.name?N.name:N.uuid)}):B.push(z);let W=x.array;if(x.normalized){const N=ft(W.constructor),U=new Float32Array(W.length);for(let H=0,ne=W.length;H<ne;H++)U[H]=W[H]*N;W=U}for(let N=0,U=B.length;N<U;N++){const H=new k(B[N]+"."+pe[D.path],A.array,W,j);O.interpolation==="CUBICSPLINE"&&(H.createInterpolant=function(Y){const J=this instanceof a.QuaternionKeyframeTrack?Qo:lt;return new J(this.times,this.values,this.getValueSize()/3,Y)},H.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(H)}}const E=e.name?e.name:"animation_"+n;return new a.AnimationClip(E,void 0,_)})}createNodeMesh(n){const t=this.json,e=this,o=t.nodes[n];return o.mesh===void 0?null:e.getDependency("mesh",o.mesh).then(function(i){const s=e._getNodeRef(e.meshCache,o.mesh,i);return o.weights!==void 0&&s.traverse(function(r){if(r.isMesh)for(let l=0,u=o.weights.length;l<u;l++)r.morphTargetInfluences[l]=o.weights[l]}),s})}loadNode(n){const t=this.json,e=this.extensions,o=this,i=t.nodes[n],s=i.name?o.createUniqueName(i.name):"";return function(){const r=[],l=o._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(n)});return l&&r.push(l),i.camera!==void 0&&r.push(o.getDependency("camera",i.camera).then(function(u){return o._getNodeRef(o.cameraCache,i.camera,u)})),o._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(n)}).forEach(function(u){r.push(u)}),Promise.all(r)}().then(function(r){let l;if(i.isBone===!0?l=new a.Bone:r.length>1?l=new a.Group:r.length===1?l=r[0]:l=new a.Object3D,l!==r[0])for(let u=0,h=r.length;u<h;u++)l.add(r[u]);if(i.name&&(l.userData.name=i.name,l.name=s),be(l,i),i.extensions&&De(e,l,i),i.matrix!==void 0){const u=new a.Matrix4;u.fromArray(i.matrix),l.applyMatrix4(u)}else i.translation!==void 0&&l.position.fromArray(i.translation),i.rotation!==void 0&&l.quaternion.fromArray(i.rotation),i.scale!==void 0&&l.scale.fromArray(i.scale);return o.associations.has(l)||o.associations.set(l,{}),o.associations.get(l).nodes=n,l})}loadScene(n){const t=this.json,e=this.extensions,o=this.json.scenes[n],i=this,s=new a.Group;o.name&&(s.name=i.createUniqueName(o.name)),be(s,o),o.extensions&&De(e,s,o);const r=o.nodes||[],l=[];for(let u=0,h=r.length;u<h;u++)l.push(tn(r[u],s,t,i));return Promise.all(l).then(function(){const u=h=>{const f=new Map;for(const[m,p]of i.associations)(m instanceof a.Material||m instanceof a.Texture)&&f.set(m,p);return h.traverse(m=>{const p=i.associations.get(m);p!=null&&f.set(m,p)}),f};return i.associations=u(s),s})}}function tn(c,n,t,e){const o=t.nodes[c];return e.getDependency("node",c).then(function(i){if(o.skin===void 0)return i;let s;return e.getDependency("skin",o.skin).then(function(r){s=r;const l=[];for(let u=0,h=s.joints.length;u<h;u++)l.push(e.getDependency("node",s.joints[u]));return Promise.all(l)}).then(function(r){return i.traverse(function(l){if(!l.isMesh)return;const u=[],h=[];for(let f=0,m=r.length;f<m;f++){const p=r[f];if(p){u.push(p);const y=new a.Matrix4;s.inverseBindMatrices!==void 0&&y.fromArray(s.inverseBindMatrices.array,f*16),h.push(y)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[f])}l.bind(new a.Skeleton(u,h),l.matrixWorld)}),i})}).then(function(i){n.add(i);const s=[];if(o.children){const r=o.children;for(let l=0,u=r.length;l<u;l++){const h=r[l];s.push(tn(h,i,t,e))}}return Promise.all(s)})}function is(c,n,t){const e=n.attributes,o=new a.Box3;if(e.POSITION!==void 0){const r=t.json.accessors[e.POSITION],l=r.min,u=r.max;if(l!==void 0&&u!==void 0){if(o.set(new a.Vector3(l[0],l[1],l[2]),new a.Vector3(u[0],u[1],u[2])),r.normalized){const h=ft(je[r.componentType]);o.min.multiplyScalar(h),o.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const i=n.targets;if(i!==void 0){const r=new a.Vector3,l=new a.Vector3;for(let u=0,h=i.length;u<h;u++){const f=i[u];if(f.POSITION!==void 0){const m=t.json.accessors[f.POSITION],p=m.min,y=m.max;if(p!==void 0&&y!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(y[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(y[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(y[2]))),m.normalized){const _=ft(je[m.componentType]);l.multiplyScalar(_)}r.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(r)}c.boundingBox=o;const s=new a.Sphere;o.getCenter(s.center),s.radius=o.min.distanceTo(o.max)/2,c.boundingSphere=s}function nn(c,n,t){const e=n.attributes,o=[];function i(s,r){return t.getDependency("accessor",s).then(function(l){c.setAttribute(r,l)})}for(const s in e){const r=ut[s]||s.toLowerCase();r in c.attributes||o.push(i(e[s],r))}if(n.indices!==void 0&&!c.index){const s=t.getDependency("accessor",n.indices).then(function(r){c.setIndex(r)});o.push(s)}return be(c,n),is(c,n,t),Promise.all(o).then(function(){return n.targets!==void 0?es(c,n.targets,t):c})}function on(c,n){let t=c.getIndex();if(t===null){const s=[],r=c.getAttribute("position");if(r!==void 0){for(let l=0;l<r.count;l++)s.push(l);c.setIndex(s),t=c.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),c}const e=t.count-2,o=[];if(n===a.TriangleFanDrawMode)for(let s=1;s<=e;s++)o.push(t.getX(0)),o.push(t.getX(s)),o.push(t.getX(s+1));else for(let s=0;s<e;s++)s%2===0?(o.push(t.getX(s)),o.push(t.getX(s+1)),o.push(t.getX(s+2))):(o.push(t.getX(s+2)),o.push(t.getX(s+1)),o.push(t.getX(s)));o.length/3!==e&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=c.clone();return i.setIndex(o),i}const sn=d.defineComponent({__name:"GLTFLoader",props:{castShadow:{type:Boolean,default:!1},enableRaycasting:{type:Boolean,default:!1},name:{default:""},onClick:{type:Function,default:()=>null},onMouseMove:{type:Function,default:()=>null},onMouseEnter:{type:Function,default:()=>null},onMouseLeave:{type:Function,default:()=>null},position:{default:()=>[0,0,0]},receiveShadow:{type:Boolean,default:!1},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]},url:null},emits:["load","progress","error"],setup(c,{expose:n,emit:t}){const e=c,o=new Po,i=new a.Group;i.castShadow=!0,i.receiveShadow=!0,K(i),L(e,"position",i),L(e,"rotation",i),L(e,"scale",i);function s(){o.load(e.url,function(l){L(e,"position",i,!1),L(e,"rotation",i,!1),L(e,"scale",i,!1),i.add(l.scene),r(),t("load",l.scene),I.object3DChanged(e.name,i)},function(l){t("progress",l)},function(l){t("error",l)})}function r(){if(i.name=e.name,i.children.length!==0)for(const l of i.children[0].children)l.castShadow=e.castShadow,l.receiveShadow=e.receiveShadow}return r(),d.watch(()=>e.url,()=>s(),{immediate:!0}),Je(i.children,e),d.provide("mesh",i),n({three:i}),(l,u)=>d.renderSlot(l.$slots,"default")}}),as=/^[og]\s*(.+)?/,rs=/^mtllib /,cs=/^usemtl /,ls=/^usemap /,an=new a.Vector3,ht=new a.Vector3,rn=new a.Vector3,cn=new a.Vector3,te=new a.Vector3,qe=new a.Color;function us(){const c={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(n,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=n,this.object.fromDeclaration=t!==!1;return}const e=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:n||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(o,i){const s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1);const r={index:this.materials.length,name:o||"",mtllib:Array.isArray(i)&&i.length>0?i[i.length-1]:"",smooth:s!==void 0?s.smooth:this.smooth,groupStart:s!==void 0?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const u={index:typeof l=="number"?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(o){const i=this.currentMaterial();if(i&&i.groupEnd===-1&&(i.groupEnd=this.geometry.vertices.length/3,i.groupCount=i.groupEnd-i.groupStart,i.inherited=!1),o&&this.materials.length>1)for(let s=this.materials.length-1;s>=0;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return o&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),i}},e&&e.name&&typeof e.clone=="function"){const o=e.clone(0);o.inherited=!0,this.object.materials.push(o)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(n,t){const e=parseInt(n,10);return(e>=0?e-1:e+t/3)*3},parseNormalIndex:function(n,t){const e=parseInt(n,10);return(e>=0?e-1:e+t/3)*3},parseUVIndex:function(n,t){const e=parseInt(n,10);return(e>=0?e-1:e+t/2)*2},addVertex:function(n,t,e){const o=this.vertices,i=this.object.geometry.vertices;i.push(o[n+0],o[n+1],o[n+2]),i.push(o[t+0],o[t+1],o[t+2]),i.push(o[e+0],o[e+1],o[e+2])},addVertexPoint:function(n){const t=this.vertices;this.object.geometry.vertices.push(t[n+0],t[n+1],t[n+2])},addVertexLine:function(n){const t=this.vertices;this.object.geometry.vertices.push(t[n+0],t[n+1],t[n+2])},addNormal:function(n,t,e){const o=this.normals,i=this.object.geometry.normals;i.push(o[n+0],o[n+1],o[n+2]),i.push(o[t+0],o[t+1],o[t+2]),i.push(o[e+0],o[e+1],o[e+2])},addFaceNormal:function(n,t,e){const o=this.vertices,i=this.object.geometry.normals;an.fromArray(o,n),ht.fromArray(o,t),rn.fromArray(o,e),te.subVectors(rn,ht),cn.subVectors(an,ht),te.cross(cn),te.normalize(),i.push(te.x,te.y,te.z),i.push(te.x,te.y,te.z),i.push(te.x,te.y,te.z)},addColor:function(n,t,e){const o=this.colors,i=this.object.geometry.colors;o[n]!==void 0&&i.push(o[n+0],o[n+1],o[n+2]),o[t]!==void 0&&i.push(o[t+0],o[t+1],o[t+2]),o[e]!==void 0&&i.push(o[e+0],o[e+1],o[e+2])},addUV:function(n,t,e){const o=this.uvs,i=this.object.geometry.uvs;i.push(o[n+0],o[n+1]),i.push(o[t+0],o[t+1]),i.push(o[e+0],o[e+1])},addDefaultUV:function(){const n=this.object.geometry.uvs;n.push(0,0),n.push(0,0),n.push(0,0)},addUVLine:function(n){const t=this.uvs;this.object.geometry.uvs.push(t[n+0],t[n+1])},addFace:function(n,t,e,o,i,s,r,l,u){const h=this.vertices.length;let f=this.parseVertexIndex(n,h),m=this.parseVertexIndex(t,h),p=this.parseVertexIndex(e,h);if(this.addVertex(f,m,p),this.addColor(f,m,p),r!==void 0&&r!==""){const y=this.normals.length;f=this.parseNormalIndex(r,y),m=this.parseNormalIndex(l,y),p=this.parseNormalIndex(u,y),this.addNormal(f,m,p)}else this.addFaceNormal(f,m,p);if(o!==void 0&&o!==""){const y=this.uvs.length;f=this.parseUVIndex(o,y),m=this.parseUVIndex(i,y),p=this.parseUVIndex(s,y),this.addUV(f,m,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(n){this.object.geometry.type="Points";const t=this.vertices.length;for(let e=0,o=n.length;e<o;e++){const i=this.parseVertexIndex(n[e],t);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(n,t){this.object.geometry.type="Line";const e=this.vertices.length,o=this.uvs.length;for(let i=0,s=n.length;i<s;i++)this.addVertexLine(this.parseVertexIndex(n[i],e));for(let i=0,s=t.length;i<s;i++)this.addUVLine(this.parseUVIndex(t[i],o))}};return c.startObject("",!1),c}class ds extends a.Loader{constructor(n){super(n),this.materials=null}load(n,t,e,o){const i=this,s=new a.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(n,function(r){try{t(i.parse(r))}catch(l){o?o(l):console.error(l),i.manager.itemError(n)}},e,o)}setMaterials(n){return this.materials=n,this}parse(n){const t=new us;n.indexOf(`\r
`)!==-1&&(n=n.replace(/\r\n/g,`
`)),n.indexOf(`\\
`)!==-1&&(n=n.replace(/\\\n/g,""));const e=n.split(`
`);let o="",i="",s=0,r=[];const l=typeof"".trimLeft=="function";for(let f=0,m=e.length;f<m;f++)if(o=e[f],o=l?o.trimLeft():o.trim(),s=o.length,s!==0&&(i=o.charAt(0),i!=="#"))if(i==="v"){const p=o.split(/\s+/);switch(p[0]){case"v":t.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),p.length>=7?(qe.setRGB(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6])).convertSRGBToLinear(),t.colors.push(qe.r,qe.g,qe.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":t.uvs.push(parseFloat(p[1]),parseFloat(p[2]));break}}else if(i==="f"){const y=o.slice(1).trim().split(/\s+/),_=[];for(let w=0,b=y.length;w<b;w++){const T=y[w];if(T.length>0){const A=T.split("/");_.push(A)}}const E=_[0];for(let w=1,b=_.length-1;w<b;w++){const T=_[w],A=_[w+1];t.addFace(E[0],T[0],A[0],E[1],T[1],A[1],E[2],T[2],A[2])}}else if(i==="l"){const p=o.substring(1).trim().split(" ");let y=[];const _=[];if(o.indexOf("/")===-1)y=p;else for(let E=0,w=p.length;E<w;E++){const b=p[E].split("/");b[0]!==""&&y.push(b[0]),b[1]!==""&&_.push(b[1])}t.addLineGeometry(y,_)}else if(i==="p"){const y=o.slice(1).trim().split(" ");t.addPointGeometry(y)}else if((r=as.exec(o))!==null){const p=(" "+r[0].slice(1).trim()).slice(1);t.startObject(p)}else if(cs.test(o))t.object.startMaterial(o.substring(7).trim(),t.materialLibraries);else if(rs.test(o))t.materialLibraries.push(o.substring(7).trim());else if(ls.test(o))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(i==="s"){if(r=o.split(" "),r.length>1){const y=r[1].trim().toLowerCase();t.object.smooth=y!=="0"&&y!=="off"}else t.object.smooth=!0;const p=t.object.currentMaterial();p&&(p.smooth=t.object.smooth)}else{if(o==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+o+'"')}t.finalize();const u=new a.Group;if(u.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let f=0,m=t.objects.length;f<m;f++){const p=t.objects[f],y=p.geometry,_=p.materials,E=y.type==="Line",w=y.type==="Points";let b=!1;if(y.vertices.length===0)continue;const T=new a.BufferGeometry;T.setAttribute("position",new a.Float32BufferAttribute(y.vertices,3)),y.normals.length>0&&T.setAttribute("normal",new a.Float32BufferAttribute(y.normals,3)),y.colors.length>0&&(b=!0,T.setAttribute("color",new a.Float32BufferAttribute(y.colors,3))),y.hasUVIndices===!0&&T.setAttribute("uv",new a.Float32BufferAttribute(y.uvs,2));const A=[];for(let O=0,D=_.length;O<D;O++){const k=_[O],z=k.name+"_"+k.smooth+"_"+b;let j=t.materials[z];if(this.materials!==null){if(j=this.materials.create(k.name),E&&j&&!(j instanceof a.LineBasicMaterial)){const B=new a.LineBasicMaterial;a.Material.prototype.copy.call(B,j),B.color.copy(j.color),j=B}else if(w&&j&&!(j instanceof a.PointsMaterial)){const B=new a.PointsMaterial({size:10,sizeAttenuation:!1});a.Material.prototype.copy.call(B,j),B.color.copy(j.color),B.map=j.map,j=B}}j===void 0&&(E?j=new a.LineBasicMaterial:w?j=new a.PointsMaterial({size:1,sizeAttenuation:!1}):j=new a.MeshPhongMaterial,j.name=k.name,j.flatShading=!k.smooth,j.vertexColors=b,t.materials[z]=j),A.push(j)}let x;if(A.length>1){for(let O=0,D=_.length;O<D;O++){const k=_[O];T.addGroup(k.groupStart,k.groupCount,O)}E?x=new a.LineSegments(T,A):w?x=new a.Points(T,A):x=new a.Mesh(T,A)}else E?x=new a.LineSegments(T,A[0]):w?x=new a.Points(T,A[0]):x=new a.Mesh(T,A[0]);x.name=p.name,u.add(x)}else if(t.vertices.length>0){const f=new a.PointsMaterial({size:1,sizeAttenuation:!1}),m=new a.BufferGeometry;m.setAttribute("position",new a.Float32BufferAttribute(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(m.setAttribute("color",new a.Float32BufferAttribute(t.colors,3)),f.vertexColors=!0);const p=new a.Points(m,f);u.add(p)}return u}}const ln=d.defineComponent({__name:"OBJLoader",props:{castShadow:{type:Boolean,default:!1},enableRaycasting:{type:Boolean,default:!1},name:{default:""},onClick:{type:Function,default:()=>null},onMouseMove:{type:Function,default:()=>null},onMouseEnter:{type:Function,default:()=>null},onMouseLeave:{type:Function,default:()=>null},position:{default:()=>[0,0,0]},receiveShadow:{type:Boolean,default:!1},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]},url:null},emits:["load","progress","error"],setup(c,{expose:n,emit:t}){const e=c,o=new ds,i=new a.Group;K(i),L(e,"position",i),L(e,"rotation",i),L(e,"scale",i);function s(){o.load(e.url,function(l){for(const u of l.children)"material"in i&&(u.material=i.material);i.add(l),r(),t("load",l),I.object3DChanged(e.name,i)},function(l){t("progress",l)},function(l){t("error",l)})}function r(){if(i.name=e.name,i.children.length!==0)for(const l of i.children[0].children)l.castShadow=e.castShadow,l.receiveShadow=e.receiveShadow}return r(),d.watch(()=>e.url,()=>s(),{immediate:!0}),Je(i.children,e),d.provide("mesh",i),n({three:i}),(l,u)=>d.renderSlot(l.$slots,"default")}}),un=d.defineComponent({__name:"AxesHelper",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},size:{default:1},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=new a.AxesHelper(t.size);return K(e),L(t,"position",e),L(t,"rotation",e),L(t,"scale",e),d.provide("mesh",e),n({three:e}),(o,i)=>d.renderSlot(o.$slots,"default")}}),dn=d.defineComponent({__name:"BoxHelper",props:{castShadow:{type:Boolean,default:!1},material:{default:null},mesh:{default:""},name:{default:""},position:{default:()=>[0,0,0]},receiveShadow:{type:Boolean,default:!1},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.BufferGeometry,i=new a.MeshBasicMaterial,s=new a.Mesh(o,i);K(s),L(t,"position",s),L(t,"rotation",s),L(t,"scale",s);function r(){s.castShadow=t.castShadow,s.receiveShadow=t.receiveShadow,s.name=t.name}r(),M(t,"castShadow",r),M(t,"receiveShadow",r);const l=d.inject("getMaterial");function u(f){const m=new a.Box3;m.setFromObject(f);const p=new a.Vector3;m.getCenter(p);const y=new a.BoxGeometry(m.max.x-m.min.x,m.max.y-m.min.y,m.max.z-m.min.z);ee(s.geometry,y),s.geometry.computeBoundingSphere(),s.position.set(p.x,p.y,p.z),I.geometryChanged(s.geometry.name,s.geometry)}const h=f=>{if("geometry"in f)f.geometry.computeBoundingBox();else for(const m of f.children)h(m)};return I.object3DChanged.on(t.mesh,f=>{h(f),d.nextTick(()=>{u(f)})}),I.object3DTranslated.on(t.mesh,f=>{h(f),d.nextTick(()=>{u(f)})}),d.onMounted(()=>{if(t.material){const f=l(t.material);s.material=f}}),d.onUnmounted(()=>{e.remove(s),ie(s)}),d.provide("mesh",s),n({three:s}),(f,m)=>d.renderSlot(f.$slots,"default")}}),fn=d.defineComponent({__name:"GridHelper",props:{colorCenterLine:{default:4473924},colorGrid:{default:8947848},divisions:{default:10},position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},size:{default:1},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=new a.GridHelper(t.size,t.divisions,t.colorCenterLine,t.colorGrid);return K(e),L(t,"position",e),L(t,"rotation",e),L(t,"scale",e),d.provide("mesh",e),n({three:e}),(o,i)=>d.renderSlot(o.$slots,"default")}}),fs={name:"BoxGeometry",render:()=>null},hn=d.defineComponent({...fs,props:{name:{default:""},width:{default:1},height:{default:1},depth:{default:1},widthSegments:{default:1},heightSegments:{default:1},depthSegments:{default:1}},setup(c,{expose:n}){const t=c;function e(l,u,h,f,m,p){return new a.BoxGeometry(l,u,h,f,m,p)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"name",()=>{o.name=t.name}),M(t,"width",r),M(t,"height",r),M(t,"depth",r),M(t,"widthSegments",r),M(t,"heightSegments",r),M(t,"depthSegments",r),n({three:o}),{props:t,makeBox:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),hs={name:"BufferGeometry",render:()=>null},pn=d.defineComponent({...hs,props:{name:{default:""},vertices:{default:()=>[]},faces:{default:()=>[]},uvs:{default:()=>[]},normals:{type:[Array,Boolean],default:!1}},setup(c,{expose:n}){const t=c;function e(){const l=new a.BufferGeometry,u=new Float32Array(t.vertices);if(l.setAttribute("position",new a.BufferAttribute(u,3)),t.uvs.length>0){const h=new Float32Array(t.uvs);l.setAttribute("uv",new a.BufferAttribute(h,2))}if(t.normals===!0&&(l.computeVertexNormals(),l.attributes.normal.needsUpdate=!0),Array.isArray(t.normals)){const h=new Float32Array(t.normals);l.setAttribute("normal",new a.BufferAttribute(h,3))}return t.faces.length>0&&l.setIndex(t.faces),l}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e();ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),d.watch(()=>t.vertices,l=>{r()},{deep:!0}),d.watch(()=>t.faces,l=>{r()},{deep:!0}),n({three:o}),{props:t,makeGeometry:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),ps={name:"CircleGeometry",render:()=>null},mn=d.defineComponent({...ps,props:{name:{default:""},radius:{default:1},segments:{default:32},thetaStart:{default:0},thetaLength:{default:2*Math.PI}},setup(c,{expose:n}){const t=c;function e(l,u,h,f){return new a.CircleGeometry(l,u,h,f)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.radius,t.segments,t.thetaStart,t.thetaLength);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"radius",r),M(t,"segments",r),M(t,"thetaStart",r),M(t,"thetaLength",r),n({three:o}),{props:t,makeCircle:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),ms={name:"ConeGeometry",render:()=>null},gn=d.defineComponent({...ms,props:{name:{default:""},radius:{default:1},height:{default:1},radialSegments:{default:32},heightSegments:{default:1},openEnded:{type:Boolean,default:!1},thetaStart:{default:0},thetaLength:{default:2*Math.PI}},setup(c,{expose:n}){const t=c;function e(l,u,h,f,m,p,y){return new a.ConeGeometry(l,u,h,f,m,p,y)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"radius",r),M(t,"height",r),M(t,"radialSegments",r),M(t,"heightSegments",r),M(t,"openEnded",r),M(t,"thetaStart",r),M(t,"thetaLength",r),n({three:o}),{props:t,makeCone:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),gs={name:"CylinderGeometry",render:()=>null},yn=d.defineComponent({...gs,props:{name:{default:""},radiusTop:{default:1},radiusBottom:{default:1},height:{default:1},radialSegments:{default:32},heightSegments:{default:1},openEnded:{type:Boolean,default:!1},thetaStart:{default:0},thetaLength:{default:2*Math.PI}},setup(c,{expose:n}){const t=c;function e(l,u,h,f,m,p,y,_){return new a.CylinderGeometry(l,u,h,f,m,p,y,_)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"radiusTop",r),M(t,"radiusBottom",r),M(t,"height",r),M(t,"radialSegments",r),M(t,"heightSegments",r),M(t,"openEnded",r),M(t,"thetaStart",r),M(t,"thetaLength",r),n({three:o}),{props:t,makeCylinder:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),ys={name:"EdgesGeometry",render:()=>null},_n=d.defineComponent({...ys,props:{geometry:null},setup(c,{expose:n}){const t=c,e=d.reactive(new a.BufferGeometry),o=d.inject("mesh",null);o&&(o.geometry=e);const i=d.inject("addGeometry");i(e);function s(r){const l=new a.EdgesGeometry(r);ee(e,l);const u=o;"isLine"in u&&u.computeLineDistances()}return I.geometryChanged.on(t.geometry,r=>{s(r)}),n({three:e}),{props:t,three:e,mesh:o,addGeometry:i,redoGeometry:s}}});class Ke extends a.BufferGeometry{constructor(n=(o,i,s)=>s.set(o,i,Math.cos(o)*Math.sin(i)),t=8,e=8){super(),this.type="ParametricGeometry",this.parameters={func:n,slices:t,stacks:e};const o=[],i=[],s=[],r=[],l=1e-5,u=new a.Vector3,h=new a.Vector3,f=new a.Vector3,m=new a.Vector3,p=new a.Vector3;n.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const y=t+1;for(let _=0;_<=e;_++){const E=_/e;for(let w=0;w<=t;w++){const b=w/t;n(b,E,h),i.push(h.x,h.y,h.z),b-l>=0?(n(b-l,E,f),m.subVectors(h,f)):(n(b+l,E,f),m.subVectors(f,h)),E-l>=0?(n(b,E-l,f),p.subVectors(h,f)):(n(b,E+l,f),p.subVectors(f,h)),u.crossVectors(m,p).normalize(),s.push(u.x,u.y,u.z),r.push(b,E)}}for(let _=0;_<e;_++)for(let E=0;E<t;E++){const w=_*y+E,b=_*y+E+1,T=(_+1)*y+E+1,A=(_+1)*y+E;o.push(w,b,A),o.push(b,T,A)}this.setIndex(o),this.setAttribute("position",new a.Float32BufferAttribute(i,3)),this.setAttribute("normal",new a.Float32BufferAttribute(s,3)),this.setAttribute("uv",new a.Float32BufferAttribute(r,2))}}const Te={klein:function(c,n,t){n*=Math.PI,c*=2*Math.PI,n=n*2;let e,o;n<Math.PI?(e=3*Math.cos(n)*(1+Math.sin(n))+2*(1-Math.cos(n)/2)*Math.cos(n)*Math.cos(c),o=-8*Math.sin(n)-2*(1-Math.cos(n)/2)*Math.sin(n)*Math.cos(c)):(e=3*Math.cos(n)*(1+Math.sin(n))+2*(1-Math.cos(n)/2)*Math.cos(c+Math.PI),o=-8*Math.sin(n));const i=-2*(1-Math.cos(n)/2)*Math.sin(c);t.set(e,i,o)},plane:function(c,n){return function(t,e,o){const i=t*c,s=0,r=e*n;o.set(i,s,r)}},mobius:function(c,n,t){c=c-.5;const e=2*Math.PI*n,o=2,i=Math.cos(e)*(o+c*Math.cos(e/2)),s=Math.sin(e)*(o+c*Math.cos(e/2)),r=c*Math.sin(e/2);t.set(i,s,r)},mobius3d:function(c,n,t){c*=Math.PI,n*=2*Math.PI,c=c*2;const e=c/2,o=2.25,i=.125,s=.65;let r=i*Math.cos(n)*Math.cos(e)-s*Math.sin(n)*Math.sin(e);const l=i*Math.cos(n)*Math.sin(e)+s*Math.sin(n)*Math.cos(e),u=(o+r)*Math.sin(c);r=(o+r)*Math.cos(c),t.set(r,u,l)}};Te.TubeGeometry=class extends Ke{constructor(n,t=64,e=1,o=8,i=!1){const s=t+1,r=n.computeFrenetFrames(t,i),l=r.tangents,u=r.normals,h=r.binormals,f=new a.Vector3;function m(p,y,_){y*=2*Math.PI;const E=Math.floor(p*(s-1));n.getPointAt(p,f);const w=u[E],b=h[E],T=-e*Math.cos(y),A=e*Math.sin(y);f.x+=T*w.x+A*b.x,f.y+=T*w.y+A*b.y,f.z+=T*w.z+A*b.z,_.copy(f)}super(m,t,o),this.tangents=l,this.normals=u,this.binormals=h,this.path=n,this.segments=t,this.radius=e,this.segmentsRadius=o,this.closed=i}},Te.TorusKnotGeometry=class extends Te.TubeGeometry{constructor(n=200,t=40,e=64,o=8,i=2,s=3){class r extends a.Curve{getPoint(m,p=new a.Vector3){const y=p;m*=Math.PI*2;const _=.5,E=(1+_*Math.cos(s*m))*Math.cos(i*m),w=(1+_*Math.cos(s*m))*Math.sin(i*m),b=_*Math.sin(s*m);return y.set(E,w,b).multiplyScalar(n)}}const l=e,u=o,h=new r;super(h,l,t,u,!0,!1),this.radius=n,this.tube=t,this.segmentsT=e,this.segmentsR=o,this.p=i,this.q=s}},Te.SphereGeometry=class extends Ke{constructor(n,t,e){function o(i,s,r){i*=Math.PI,s*=2*Math.PI;const l=n*Math.sin(i)*Math.cos(s),u=n*Math.sin(i)*Math.sin(s),h=n*Math.cos(i);r.set(l,u,h)}super(o,t,e)}},Te.PlaneGeometry=class extends Ke{constructor(n,t,e,o){function i(s,r,l){const u=s*n,h=0,f=r*t;l.set(u,h,f)}super(i,e,o)}};const _s={name:"Parametriceometry",render:()=>null},wn=d.defineComponent({..._s,props:{name:{default:""},function:{type:Function,default:Te.klein},slices:{default:8},stacks:{default:8}},setup(c,{expose:n}){const t=c;function e(l,u,h){return new Ke(l,u,h)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.function,t.slices,t.stacks);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"function",r),M(t,"stacks",r),M(t,"slices",r),n({three:o}),{props:t,makePlane:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),ws={name:"PlaneGeometry",render:()=>null},Mn=d.defineComponent({...ws,props:{name:{default:""},width:{default:1},height:{default:1},widthSegments:{default:1},heightSegments:{default:1}},setup(c,{expose:n}){const t=c;function e(l,u,h,f){return new a.PlaneGeometry(l,u,h,f)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.width,t.height,t.widthSegments,t.heightSegments);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"width",r),M(t,"height",r),M(t,"widthSegments",r),M(t,"heightSegments",r),n({three:o}),{props:t,makePlane:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),Ms={name:"RingGeometry",render:()=>null},bn=d.defineComponent({...Ms,props:{name:{default:""},innerRadius:{default:.5},outerRadius:{default:1},thetaSegments:{default:32},phiSegments:{default:1},thetaStart:{default:0},thetaLength:{default:2*Math.PI}},setup(c,{expose:n}){const t=c;function e(l,u,h,f,m,p){return new a.RingGeometry(l,u,h,f,m,p)}const o=d.reactive(new a.BufferGeometry);o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"innerRadius",r),M(t,"outerRadius",r),M(t,"thetaSegments",r),M(t,"phiSegments",r),M(t,"thetaStart",r),M(t,"thetaLength",r),n({three:o}),{props:t,makeRing:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),bs={name:"SphereGeometry",render:()=>null},En=d.defineComponent({...bs,props:{name:{default:""},radius:{default:1},widthSegments:{default:32},heightSegments:{default:16},phiStart:{default:0},phiLength:{default:2*Math.PI},thetaStart:{default:0},thetaLength:{default:Math.PI}},setup(c,{expose:n}){const t=c;function e(l,u,h,f,m,p,y){return new a.SphereGeometry(l,u,h,f,m,p,y)}const o=new a.BufferGeometry;o.name=t.name;const i=d.inject("mesh",null);i&&(i.geometry=o);const s=d.inject("addGeometry");s(o);function r(){const l=e(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength);ee(o,l),I.geometryChanged(t.name,o),i&&I.object3DChanged(i.name,i)}return d.onMounted(r),M(t,"radius",r),M(t,"widthSegments",r),M(t,"heightSegments",r),M(t,"phiStart",r),M(t,"phiLength",r),M(t,"thetaStart",r),M(t,"thetaLength",r),n({three:o}),{props:t,makeSphere:e,three:o,mesh:i,addGeometry:s,redoGeometry:r}}}),Es={name:"WireframeGeometry",render:()=>null},Sn=d.defineComponent({...Es,props:{geometry:null},setup(c,{expose:n}){const t=c,e=d.reactive(new a.BufferGeometry),o=d.inject("mesh",null);o&&(o.geometry=e);const i=d.inject("addGeometry");i(e);function s(r){const l=new a.WireframeGeometry(r);ee(e,l);const u=o;"isLine"in u&&u.computeLineDistances()}return I.geometryChanged.on(t.geometry,r=>{s(r)}),n({three:e}),{props:t,three:e,mesh:o,addGeometry:i,redoGeometry:s}}}),Ss={name:"LineBasicMaterial",render:()=>null},Tn=d.defineComponent({...Ss,props:{color:{default:16777215},name:{default:""},opacity:{default:1},transparent:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.LineBasicMaterial({color:t.color});e.name=t.name;const o=d.inject("addMaterial");o(e);const i=d.inject("mesh",null);i&&(i.material=e);function s(){t.color&&(e.color=new a.Color(t.color)),e.opacity=t.opacity,e.transparent=t.transparent,e.needsUpdate=!0}return s(),M(t,"color",s),M(t,"opacity",s),M(t,"transparent",s),d.provide("material",e),n({three:e}),{props:t,three:e,addMaterial:o,mesh:i,applyProps:s}}}),Ts={name:"LineDashedMaterial",render:()=>null},xn=d.defineComponent({...Ts,props:{color:{default:16777215},scale:{default:1},dashSize:{default:3},gapSize:{default:1},name:{default:""},opacity:{default:1},transparent:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.LineDashedMaterial({color:t.color});e.name=t.name;const o=d.inject("addMaterial");o(e);const i=d.inject("mesh",null);i&&(i.material=e);function s(){e.color=new a.Color(t.color),e.scale=t.scale,e.dashSize=t.dashSize,e.gapSize=t.gapSize,e.opacity=t.opacity,e.transparent=t.transparent,e.needsUpdate=!0}return s(),M(t,"color",s),M(t,"scale",s),M(t,"dashSize",s),M(t,"gapSize",s),M(t,"opacity",s),M(t,"transparent",s),d.provide("material",e),n({three:e}),{props:t,three:e,addMaterial:o,mesh:i,applyProps:s}}}),xs={name:"MeshBasicMaterial"},An=d.defineComponent({...xs,props:{color:null,side:{default:a.FrontSide},name:{default:""},opacity:{default:1},transparent:{type:Boolean,default:!1},vertexColors:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.MeshBasicMaterial;e.name=t.name,d.inject("addMaterial")(e);const i=d.inject("mesh",null);i&&(i.material=e);function s(){t.color!==void 0&&(e.color=new a.Color(t.color)),e.side=t.side,e.opacity=t.opacity,e.transparent=t.transparent,e.vertexColors=t.vertexColors,e.needsUpdate=!0}return s(),d.provide("material",e),M(t,"color",s),M(t,"side",s),M(t,"opacity",s),M(t,"transparent",s),M(t,"vertexColors",s),n({three:e}),(r,l)=>d.renderSlot(r.$slots,"default")}}),As={name:"MeshLambertMaterial"},Cn=d.defineComponent({...As,props:{color:{default:16777215},name:{default:""},side:{default:a.FrontSide},opacity:{default:1},transparent:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.MeshLambertMaterial;e.name=t.name,d.inject("addMaterial")(e);const i=d.inject("mesh",null);i&&(i.material=e);function s(r){r.color&&(e.color=new a.Color(r.color)),r.side&&(e.side=r.side)}return s(t),d.watch(()=>t.color,()=>s(t)),d.watch(()=>t.side,()=>s(t)),d.watch(()=>t.opacity,()=>{e.opacity=t.opacity},{immediate:!0}),d.watch(()=>t.transparent,()=>{e.transparent=t.transparent},{immediate:!0}),d.provide("material",e),n({three:e}),(r,l)=>d.renderSlot(r.$slots,"default")}}),Cs={name:"PointsMaterial",render:()=>null},Ln=d.defineComponent({...Cs,props:{color:{default:16777215},sizeAttenuation:{type:Boolean,default:!0},name:{default:""},size:{default:1},opacity:{default:1},transparent:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.PointsMaterial({color:t.color,sizeAttenuation:t.sizeAttenuation,size:t.size});e.name=t.name;const o=d.inject("mesh",null),i=d.inject("addMaterial");i(e),o&&(o.material=e);function s(){e.color=new a.Color(t.color),e.size=t.size,e.sizeAttenuation=t.sizeAttenuation,e.opacity=t.opacity,e.transparent=t.transparent,e.needsUpdate=!0}return s(),M(t,"color",s),M(t,"size",s),M(t,"sizeAttenuation",s),M(t,"opacity",s),M(t,"transparent",s),d.provide("material",e),n({three:e}),{props:t,three:e,mesh:o,addMaterial:i,applyProps:s}}}),Ls={name:"MeshNormalMaterial"},Rn=d.defineComponent({...Ls,props:{side:{default:a.FrontSide},name:{default:""},opacity:{default:1},transparent:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.MeshNormalMaterial;e.name=t.name,d.inject("addMaterial")(e);const i=d.inject("mesh",null);return i&&(i.material=e),d.watch(()=>t.side,()=>{e.side=t.side},{immediate:!0}),d.watch(()=>t.opacity,()=>{e.opacity=t.opacity},{immediate:!0}),d.watch(()=>t.transparent,()=>{e.transparent=t.transparent},{immediate:!0}),d.provide("material",e),n({three:e}),(s,r)=>d.renderSlot(s.$slots,"default")}}),Rs={name:"MeshStandardMaterial"},Pn=d.defineComponent({...Rs,props:{color:null,side:{default:a.FrontSide},name:{default:""},opacity:{default:1},transparent:{type:Boolean,default:!1},vertexColors:{type:Boolean,default:!1}},setup(c,{expose:n}){const t=c,e=new a.MeshStandardMaterial;e.name=t.name,d.inject("addMaterial")(e);const i=d.inject("mesh",null);i&&(i.material=e);function s(){t.color!==void 0&&(e.color=new a.Color(t.color)),e.side=t.side,e.opacity=t.opacity,e.transparent=t.transparent,e.vertexColors=t.vertexColors,e.needsUpdate=!0}return s(),d.provide("material",e),M(t,"color",s),M(t,"side",s),M(t,"opacity",s),M(t,"transparent",s),M(t,"vertexColors",s),n({three:e}),(r,l)=>d.renderSlot(r.$slots,"default")}}),Ps={name:"AmbientLight",render:()=>null},vn=d.defineComponent({...Ps,props:{color:{default:16777215},intensity:{default:1}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.AmbientLight;e.add(o);function i(s){o.color=new a.Color(s.color),o.intensity=s.intensity}return i(t),d.watch(()=>t.color,()=>i(t)),d.watch(()=>t.intensity,()=>i(t)),n({three:o}),{props:t,scene:e,three:o,applyProps:i}}}),vs={name:"DirectionalLight",render:()=>null},On=d.defineComponent({...vs,props:{castShadow:{type:Boolean,default:!1},color:{default:16777215},intensity:{default:1},position:{default:()=>[0,0,0]}},setup(c,{expose:n}){const t=c,e=new a.DirectionalLight;K(e);function o(){e.color=new a.Color(t.color),e.intensity=t.intensity,e.castShadow=t.castShadow}return o(),M(t,"color",o),M(t,"intensity",o),M(t,"castShadow",o),L(t,"position",e),n({three:e}),{props:t,three:e,applyProps:o}}}),Os={name:"HemisphereLight",render:()=>null},In=d.defineComponent({...Os,props:{groundColor:{default:16777215},intensity:{default:1},skyColor:{default:16777215}},setup(c,{expose:n}){const t=c,e=d.inject("scene"),o=new a.HemisphereLight;e.add(o);function i(){o.color=new a.Color(t.skyColor),o.groundColor=new a.Color(t.groundColor),o.intensity=t.intensity}return i(),M(t,"skyColor",i),M(t,"groundColor",i),M(t,"intensity",i),n({three:o}),{props:t,scene:e,three:o,applyProps:i}}}),Is={name:"PointLight",render:()=>null},kn=d.defineComponent({...Is,props:{castShadow:{type:Boolean,default:!1},color:{default:16777215},intensity:{default:1},position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(c,{expose:n}){const t=c,e=new a.PointLight;K(e),L(t,"position",e),L(t,"rotation",e),L(t,"scale",e);function o(i){e.color=new a.Color(i.color),e.intensity=i.intensity,e.castShadow=i.castShadow}return o(t),d.watch(()=>t.color,()=>o(t)),d.watch(()=>t.intensity,()=>o(t)),d.watch(()=>t.castShadow,()=>o(t)),n({three:e}),{props:t,three:e,applyProps:o}}}),ks={name:"TextureLoader",render:()=>null},jn=d.defineComponent({...ks,props:{offset:{default:()=>[0,0]},repeat:{default:()=>[1,1]},rotation:{default:0},url:null,wrapS:{default:a.ClampToEdgeWrapping},wrapT:{default:a.ClampToEdgeWrapping}},setup(c,{expose:n}){const t=c,e=d.inject("material"),o=d.ref(new a.Texture);function i(){new a.TextureLoader().loadAsync(t.url).then(r=>{o.value=r,bt(t,"offset",o.value),bt(t,"repeat",o.value),"map"in e&&(e.map=o.value,e.needsUpdate=!0),s()})}function s(){o.value.wrapS=t.wrapS,o.value.wrapT=t.wrapT,o.value.rotation=t.rotation,o.value.needsUpdate=!0}return i(),M(t,"url",i),M(t,"wrapS",s),M(t,"wrapT",s),M(t,"rotation",s),n({three:o}),{props:t,material:e,three:o,load:i,applyProps:s}}});function Dn(c){c.component("Renderer",At),c.component("Scene",Ct),c.component("PerspectiveCamera",Lt),c.component("OrthographicCamera",Rt),c.component("OrbitControls",Ot),c.component("TrackballControls",It),c.component("TransformControls",Bt),c.component("Group",Ut),c.component("InstancedMesh",Vt),c.component("Line",zt),c.component("LineLoop",$t),c.component("LineSegments",Xt),c.component("Mesh",Yt),c.component("Points",Zt),c.component("GLTFLoader",sn),c.component("OBJLoader",ln),c.component("AxesHelper",un),c.component("BoxHelper",dn),c.component("GridHelper",fn),c.component("BoxGeometry",hn),c.component("BufferGeometry",pn),c.component("CircleGeometry",mn),c.component("ConeGeometry",gn),c.component("CylinderGeometry",yn),c.component("EdgesGeometry",_n),c.component("ParametricGeometry",wn),c.component("PlaneGeometry",Mn),c.component("RingGeometry",bn),c.component("SphereGeometry",En),c.component("WireframeGeometry",Sn),c.component("LineBasicMaterial",Tn),c.component("LineDashedMaterial",xn),c.component("MeshBasicMaterial",An),c.component("MeshLambertMaterial",Cn),c.component("PointsMaterial",Ln),c.component("MeshNormalMaterial",Rn),c.component("MeshStandardMaterial",Pn),c.component("AmbientLight",vn),c.component("DirectionalLight",On),c.component("HemisphereLight",In),c.component("PointLight",kn),c.component("TextureLoader",jn)}C.AmbientLight=vn,C.AxesHelper=un,C.BoxGeometry=hn,C.BoxHelper=dn,C.BufferGeometry=pn,C.CircleGeometry=mn,C.ConeGeometry=gn,C.CylinderGeometry=yn,C.DirectionalLight=On,C.EdgesGeometry=_n,C.GLTFLoader=sn,C.GridHelper=fn,C.Group=Ut,C.HemisphereLight=In,C.InstancedMesh=Vt,C.Line=zt,C.LineBasicMaterial=Tn,C.LineDashedMaterial=xn,C.LineLoop=$t,C.LineSegments=Xt,C.Mesh=Yt,C.MeshBasicMaterial=An,C.MeshLambertMaterial=Cn,C.MeshNormalMaterial=Rn,C.MeshStandardMaterial=Pn,C.OBJLoader=ln,C.OrbitControls=Ot,C.OrthographicCamera=Rt,C.ParametricGeometry=wn,C.PerspectiveCamera=Lt,C.PlaneGeometry=Mn,C.PointLight=kn,C.Points=Zt,C.PointsMaterial=Ln,C.Renderer=At,C.RingGeometry=bn,C.Scene=Ct,C.SphereGeometry=En,C.TextureLoader=jn,C.TrackballControls=It,C.TransformControls=Bt,C.WireframeGeometry=Sn,C.default=Dn,C.install=Dn,Object.defineProperties(C,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
