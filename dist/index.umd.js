(function(P,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue"),require("three")):typeof define=="function"&&define.amd?define(["exports","vue","three"],r):(P=typeof globalThis<"u"?globalThis:P||self,r(P["@janvorisek/drie"]={},P.Vue,P.three))})(this,function(P,r,c){"use strict";const W=r.defineComponent({__name:"Renderer",props:{camera:null,autoResize:{type:Boolean,default:!0},onBeforeRender:{type:Function,default:()=>{}},antialias:{type:Boolean,default:!1},shadowMapEnabled:{type:Boolean,default:!1}},setup(l,{expose:a}){const t=l;let e=null;const n=[];let o=null;const i=r.ref([]),d=r.ref([]),h=r.ref();r.provide("canvas",h);let _=Date.now();const L=1e3/30;r.watch(()=>t.camera,u=>g(u));const g=u=>{if(u){const w=i.value.find(b=>b.name===u);w===void 0&&(o=null),o=w}else o=i.value[0]};function y(u){e!==null&&(e.shadowMap.enabled=u.shadowMapEnabled)}r.onMounted(()=>{e=new c.WebGLRenderer({canvas:h.value,antialias:t.antialias}),e.setSize(1,1),y(t),g(t.camera),new ResizeObserver(w=>{w.forEach(b=>{e&&t.autoResize&&e.setSize(b.contentRect.width,b.contentRect.height)})}).observe(h.value.parentElement),f()});function f(){requestAnimationFrame(f);const u=Date.now(),w=u-_;if(!(w<L)){if(_=u-w%L,t.onBeforeRender&&t.onBeforeRender(),d.value.length>0&&o)for(const b of d.value)b.value!==null&&(b.value.object.uuid===o.uuid?(b.value.enabled=!0,b.value.update()):b.value.enabled=!1);if(o&&e)for(const b of n)e.render(b,o)}}return y(t),r.watch(()=>t.shadowMapEnabled,()=>y(t)),r.provide("addCamera",u=>i.value.push(u)),r.provide("addScene",u=>n.push(u)),r.provide("addControls",u=>d.value.push(u)),a({three:e}),(u,w)=>(r.openBlock(),r.createElementBlock(r.Fragment,null,[r.renderSlot(u.$slots,"default"),r.createElementVNode("canvas",{ref_key:"canvas",ref:h},null,512)],64))}}),J=r.defineComponent({__name:"Scene",props:{background:{default:16777215}},setup(l,{expose:a}){const t=l,e=new c.Scene;r.provide("scene",e),r.inject("addScene")(e);function n(o){o.background&&(e.background=new c.Color(o.background))}return n(t),r.watch(()=>t.background,()=>n(t)),a({three:e}),(o,i)=>r.renderSlot(o.$slots,"default")}}),Q=l=>l===void 0?new c.Vector3(0,0,0):"x"in l?new c.Vector3(l.x,l.y,l.z):new c.Vector3(l[0],l[1],l[2]),ee=(l,a,t)=>{t[l].isVector3?t[l].set(a.x,a.y,a.z):"isEuler"in t[l]&&t[l].setFromVector3(a)},S=(l,a,t,e=!0)=>{if(l[a]!==void 0){const n=Q(l[a]);if("isGroup"in t)for(const o of t.children)S(l,a,o,!1);else ee(a,n,t)}e&&r.watch(()=>l[a],()=>{if(l[a]!==void 0){const n=Q(l[a]);if("isGroup"in t)for(const o of t.children)S(l,a,o,!1);else ee(a,n,t)}})},T=(l,a,t)=>{r.watch(()=>l[a],()=>t)},ve={name:"PerspectiveCamera"},te=r.defineComponent({...ve,props:{name:{default:""},up:{default:()=>[0,1,0]},position:{default:()=>[0,0,0]},lookAt:{default:()=>[0,0,0]}},setup(l,{expose:a}){const t=l,e=new c.PerspectiveCamera(75,window.innerWidth/window.innerHeight*1e3,.1,1e3);r.inject("addCamera")(e);const n=r.inject("canvas");r.onMounted(()=>{t.name&&(e.name=t.name),new ResizeObserver(d=>{d.forEach(h=>{e.aspect=h.contentRect.width/h.contentRect.height,e.updateProjectionMatrix()})}).observe(n.value)}),S(t,"position",e),S(t,"up",e),S(t,"lookAt",e);function o(i){}return r.watch(t,()=>void 0),r.provide("parentCamera",e),a({three:e}),(i,d)=>r.renderSlot(i.$slots,"default")}}),Fe={name:"OrthographicCamera"},ne=r.defineComponent({...Fe,props:{name:{default:""},up:{default:()=>[0,1,0]},position:{default:()=>[0,0,0]},lookAt:{default:()=>[0,0,0]}},setup(l,{expose:a}){const t=l,e=new c.OrthographicCamera(-30,30,30,-30,.1,1e3);e.lookAt(0,0,0),e.updateProjectionMatrix(),r.inject("addCamera")(e),r.onMounted(()=>{t.name&&(e.name=t.name)}),S(t,"position",e),S(t,"up",e),S(t,"lookAt",e);function n(o){}return r.watch(t,()=>void 0),r.provide("parentCamera",e),a({three:e}),(o,i)=>r.renderSlot(o.$slots,"default")}}),oe={type:"change"},H={type:"start"},se={type:"end"};class Ue extends c.EventDispatcher{constructor(a,t){super(),t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=a,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new c.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:c.MOUSE.ROTATE,MIDDLE:c.MOUSE.DOLLY,RIGHT:c.MOUSE.PAN},this.touches={ONE:c.TOUCH.ROTATE,TWO:c.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return d.phi},this.getAzimuthalAngle=function(){return d.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(s){s.addEventListener("keydown",De),this._domElementKeyEvents=s},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(oe),e.update(),o=n.NONE},this.update=function(){const s=new c.Vector3,m=new c.Quaternion().setFromUnitVectors(a.up,new c.Vector3(0,1,0)),C=m.clone().invert(),x=new c.Vector3,D=new c.Quaternion,v=2*Math.PI;return function(){const $e=e.object.position;s.copy($e).sub(e.target),s.applyQuaternion(m),d.setFromVector3(s),e.autoRotate&&o===n.NONE&&B(F()),e.enableDamping?(d.theta+=h.theta*e.dampingFactor,d.phi+=h.phi*e.dampingFactor):(d.theta+=h.theta,d.phi+=h.phi);let I=e.minAzimuthAngle,N=e.maxAzimuthAngle;return isFinite(I)&&isFinite(N)&&(I<-Math.PI?I+=v:I>Math.PI&&(I-=v),N<-Math.PI?N+=v:N>Math.PI&&(N-=v),I<=N?d.theta=Math.max(I,Math.min(N,d.theta)):d.theta=d.theta>(I+N)/2?Math.max(I,d.theta):Math.min(N,d.theta)),d.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,d.phi)),d.makeSafe(),d.radius*=_,d.radius=Math.max(e.minDistance,Math.min(e.maxDistance,d.radius)),e.enableDamping===!0?e.target.addScaledVector(L,e.dampingFactor):e.target.add(L),s.setFromSpherical(d),s.applyQuaternion(C),$e.copy(e.target).add(s),e.object.lookAt(e.target),e.enableDamping===!0?(h.theta*=1-e.dampingFactor,h.phi*=1-e.dampingFactor,L.multiplyScalar(1-e.dampingFactor)):(h.set(0,0,0),L.set(0,0,0)),_=1,g||x.distanceToSquared(e.object.position)>i||8*(1-D.dot(e.object.quaternion))>i?(e.dispatchEvent(oe),x.copy(e.object.position),D.copy(e.object.quaternion),g=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Ie),e.domElement.removeEventListener("pointerdown",Re),e.domElement.removeEventListener("pointercancel",ze),e.domElement.removeEventListener("wheel",ke),e.domElement.removeEventListener("pointermove",X),e.domElement.removeEventListener("pointerup",K),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",De)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=n.NONE;const i=1e-6,d=new c.Spherical,h=new c.Spherical;let _=1;const L=new c.Vector3;let g=!1;const y=new c.Vector2,f=new c.Vector2,u=new c.Vector2,w=new c.Vector2,b=new c.Vector2,O=new c.Vector2,A=new c.Vector2,M=new c.Vector2,j=new c.Vector2,p=[],V={};function F(){return 2*Math.PI/60/60*e.autoRotateSpeed}function R(){return Math.pow(.95,e.zoomSpeed)}function B(s){h.theta-=s}function E(s){h.phi-=s}const k=function(){const s=new c.Vector3;return function(C,x){s.setFromMatrixColumn(x,0),s.multiplyScalar(-C),L.add(s)}}(),Me=function(){const s=new c.Vector3;return function(C,x){e.screenSpacePanning===!0?s.setFromMatrixColumn(x,1):(s.setFromMatrixColumn(x,0),s.crossVectors(e.object.up,s)),s.multiplyScalar(C),L.add(s)}}(),$=function(){const s=new c.Vector3;return function(C,x){const D=e.domElement;if(e.object.isPerspectiveCamera){const v=e.object.position;s.copy(v).sub(e.target);let G=s.length();G*=Math.tan(e.object.fov/2*Math.PI/180),k(2*C*G/D.clientHeight,e.object.matrix),Me(2*x*G/D.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(k(C*(e.object.right-e.object.left)/e.object.zoom/D.clientWidth,e.object.matrix),Me(x*(e.object.top-e.object.bottom)/e.object.zoom/D.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function Z(s){e.object.isPerspectiveCamera?_/=s:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*s)),e.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Ee(s){e.object.isPerspectiveCamera?_*=s:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/s)),e.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Le(s){y.set(s.clientX,s.clientY)}function ct(s){A.set(s.clientX,s.clientY)}function Oe(s){w.set(s.clientX,s.clientY)}function lt(s){f.set(s.clientX,s.clientY),u.subVectors(f,y).multiplyScalar(e.rotateSpeed);const m=e.domElement;B(2*Math.PI*u.x/m.clientHeight),E(2*Math.PI*u.y/m.clientHeight),y.copy(f),e.update()}function dt(s){M.set(s.clientX,s.clientY),j.subVectors(M,A),j.y>0?Z(R()):j.y<0&&Ee(R()),A.copy(M),e.update()}function ut(s){b.set(s.clientX,s.clientY),O.subVectors(b,w).multiplyScalar(e.panSpeed),$(O.x,O.y),w.copy(b),e.update()}function ft(s){s.deltaY<0?Ee(R()):s.deltaY>0&&Z(R()),e.update()}function mt(s){let m=!1;switch(s.code){case e.keys.UP:$(0,e.keyPanSpeed),m=!0;break;case e.keys.BOTTOM:$(0,-e.keyPanSpeed),m=!0;break;case e.keys.LEFT:$(e.keyPanSpeed,0),m=!0;break;case e.keys.RIGHT:$(-e.keyPanSpeed,0),m=!0;break}m&&(s.preventDefault(),e.update())}function je(){if(p.length===1)y.set(p[0].pageX,p[0].pageY);else{const s=.5*(p[0].pageX+p[1].pageX),m=.5*(p[0].pageY+p[1].pageY);y.set(s,m)}}function Ae(){if(p.length===1)w.set(p[0].pageX,p[0].pageY);else{const s=.5*(p[0].pageX+p[1].pageX),m=.5*(p[0].pageY+p[1].pageY);w.set(s,m)}}function Ce(){const s=p[0].pageX-p[1].pageX,m=p[0].pageY-p[1].pageY,C=Math.sqrt(s*s+m*m);A.set(0,C)}function ht(){e.enableZoom&&Ce(),e.enablePan&&Ae()}function pt(){e.enableZoom&&Ce(),e.enableRotate&&je()}function Te(s){if(p.length==1)f.set(s.pageX,s.pageY);else{const C=q(s),x=.5*(s.pageX+C.x),D=.5*(s.pageY+C.y);f.set(x,D)}u.subVectors(f,y).multiplyScalar(e.rotateSpeed);const m=e.domElement;B(2*Math.PI*u.x/m.clientHeight),E(2*Math.PI*u.y/m.clientHeight),y.copy(f)}function xe(s){if(p.length===1)b.set(s.pageX,s.pageY);else{const m=q(s),C=.5*(s.pageX+m.x),x=.5*(s.pageY+m.y);b.set(C,x)}O.subVectors(b,w).multiplyScalar(e.panSpeed),$(O.x,O.y),w.copy(b)}function Ve(s){const m=q(s),C=s.pageX-m.x,x=s.pageY-m.y,D=Math.sqrt(C*C+x*x);M.set(0,D),j.set(0,Math.pow(M.y/A.y,e.zoomSpeed)),Z(j.y),A.copy(M)}function gt(s){e.enableZoom&&Ve(s),e.enablePan&&xe(s)}function bt(s){e.enableZoom&&Ve(s),e.enableRotate&&Te(s)}function Re(s){e.enabled!==!1&&(p.length===0&&(e.domElement.setPointerCapture(s.pointerId),e.domElement.addEventListener("pointermove",X),e.domElement.addEventListener("pointerup",K)),St(s),s.pointerType==="touch"?_t(s):yt(s))}function X(s){e.enabled!==!1&&(s.pointerType==="touch"?Pt(s):wt(s))}function K(s){Ne(s),p.length===0&&(e.domElement.releasePointerCapture(s.pointerId),e.domElement.removeEventListener("pointermove",X),e.domElement.removeEventListener("pointerup",K)),e.dispatchEvent(se),o=n.NONE}function ze(s){Ne(s)}function yt(s){let m;switch(s.button){case 0:m=e.mouseButtons.LEFT;break;case 1:m=e.mouseButtons.MIDDLE;break;case 2:m=e.mouseButtons.RIGHT;break;default:m=-1}switch(m){case c.MOUSE.DOLLY:if(e.enableZoom===!1)return;ct(s),o=n.DOLLY;break;case c.MOUSE.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(e.enablePan===!1)return;Oe(s),o=n.PAN}else{if(e.enableRotate===!1)return;Le(s),o=n.ROTATE}break;case c.MOUSE.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(e.enableRotate===!1)return;Le(s),o=n.ROTATE}else{if(e.enablePan===!1)return;Oe(s),o=n.PAN}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(H)}function wt(s){if(e.enabled!==!1)switch(o){case n.ROTATE:if(e.enableRotate===!1)return;lt(s);break;case n.DOLLY:if(e.enableZoom===!1)return;dt(s);break;case n.PAN:if(e.enablePan===!1)return;ut(s);break}}function ke(s){e.enabled===!1||e.enableZoom===!1||o!==n.NONE||(s.preventDefault(),e.dispatchEvent(H),ft(s),e.dispatchEvent(se))}function De(s){e.enabled===!1||e.enablePan===!1||mt(s)}function _t(s){switch(Be(s),p.length){case 1:switch(e.touches.ONE){case c.TOUCH.ROTATE:if(e.enableRotate===!1)return;je(),o=n.TOUCH_ROTATE;break;case c.TOUCH.PAN:if(e.enablePan===!1)return;Ae(),o=n.TOUCH_PAN;break;default:o=n.NONE}break;case 2:switch(e.touches.TWO){case c.TOUCH.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ht(),o=n.TOUCH_DOLLY_PAN;break;case c.TOUCH.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;pt(),o=n.TOUCH_DOLLY_ROTATE;break;default:o=n.NONE}break;default:o=n.NONE}o!==n.NONE&&e.dispatchEvent(H)}function Pt(s){switch(Be(s),o){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;Te(s),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;xe(s),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;gt(s),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;bt(s),e.update();break;default:o=n.NONE}}function Ie(s){e.enabled!==!1&&s.preventDefault()}function St(s){p.push(s)}function Ne(s){delete V[s.pointerId];for(let m=0;m<p.length;m++)if(p[m].pointerId==s.pointerId){p.splice(m,1);return}}function Be(s){let m=V[s.pointerId];m===void 0&&(m=new c.Vector2,V[s.pointerId]=m),m.set(s.pageX,s.pageY)}function q(s){const m=s.pointerId===p[0].pointerId?p[1]:p[0];return V[m.pointerId]}e.domElement.addEventListener("contextmenu",Ie),e.domElement.addEventListener("pointerdown",Re),e.domElement.addEventListener("pointercancel",ze),e.domElement.addEventListener("wheel",ke,{passive:!1}),this.update()}}const Ge={name:"OrbitControls",render:()=>null},ae=r.defineComponent({...Ge,props:{name:null},setup(l,{expose:a}){const t=l,e=r.ref(null);r.inject("addControls")(e);const n=r.inject("parentCamera"),o=r.inject("canvas");return r.watch(o,()=>{e.value=new Ue(n,o.value)}),a({three:e.value}),{props:t,three:e,camera:n,canvas:o}}}),ie=r.defineComponent({__name:"Mesh",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]},castShadow:{type:Boolean,default:!1},receiveShadow:{type:Boolean,default:!1}},setup(l,{expose:a}){const t=l,e=r.inject("scene"),n=new c.BufferGeometry,o=new c.MeshBasicMaterial,i=new c.Mesh(n,o);i.castShadow=!0,i.receiveShadow=!0,e.add(i),S(t,"position",i),S(t,"rotation",i),S(t,"scale",i);function d(h){i.castShadow=h.castShadow,i.receiveShadow=h.receiveShadow}return d(t),r.watch(()=>t.castShadow,()=>d(t)),r.watch(()=>t.receiveShadow,()=>d(t)),r.provide("mesh",i),a({three:i}),(h,_)=>r.renderSlot(h.$slots,"default")}}),re=r.defineComponent({__name:"Points",props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(l,{expose:a}){const t=l,e=r.inject("scene"),n=new c.BufferGeometry,o=new c.PointsMaterial({color:"red",sizeAttenuation:!1,size:2}),i=new c.Points(n,o);return e.add(i),S(t,"position",i),S(t,"rotation",i),S(t,"scale",i),r.provide("mesh",i),a({three:i}),(d,h)=>r.renderSlot(d.$slots,"default")}}),He=/^[og]\s*(.+)?/,Ye=/^mtllib /,Ze=/^usemtl /,Xe=/^usemap /,ce=new c.Vector3,Y=new c.Vector3,le=new c.Vector3,de=new c.Vector3,z=new c.Vector3,U=new c.Color;function Ke(){const l={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(a,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=a,this.object.fromDeclaration=t!==!1;return}const e=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:a||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(n,o){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const d={index:this.materials.length,name:n||"",mtllib:Array.isArray(o)&&o.length>0?o[o.length-1]:"",smooth:i!==void 0?i.smooth:this.smooth,groupStart:i!==void 0?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(h){const _={index:typeof h=="number"?h:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return _.clone=this.clone.bind(_),_}};return this.materials.push(d),d},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(n){const o=this.currentMaterial();if(o&&o.groupEnd===-1&&(o.groupEnd=this.geometry.vertices.length/3,o.groupCount=o.groupEnd-o.groupStart,o.inherited=!1),n&&this.materials.length>1)for(let i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return n&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),o}},e&&e.name&&typeof e.clone=="function"){const n=e.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(a,t){const e=parseInt(a,10);return(e>=0?e-1:e+t/3)*3},parseNormalIndex:function(a,t){const e=parseInt(a,10);return(e>=0?e-1:e+t/3)*3},parseUVIndex:function(a,t){const e=parseInt(a,10);return(e>=0?e-1:e+t/2)*2},addVertex:function(a,t,e){const n=this.vertices,o=this.object.geometry.vertices;o.push(n[a+0],n[a+1],n[a+2]),o.push(n[t+0],n[t+1],n[t+2]),o.push(n[e+0],n[e+1],n[e+2])},addVertexPoint:function(a){const t=this.vertices;this.object.geometry.vertices.push(t[a+0],t[a+1],t[a+2])},addVertexLine:function(a){const t=this.vertices;this.object.geometry.vertices.push(t[a+0],t[a+1],t[a+2])},addNormal:function(a,t,e){const n=this.normals,o=this.object.geometry.normals;o.push(n[a+0],n[a+1],n[a+2]),o.push(n[t+0],n[t+1],n[t+2]),o.push(n[e+0],n[e+1],n[e+2])},addFaceNormal:function(a,t,e){const n=this.vertices,o=this.object.geometry.normals;ce.fromArray(n,a),Y.fromArray(n,t),le.fromArray(n,e),z.subVectors(le,Y),de.subVectors(ce,Y),z.cross(de),z.normalize(),o.push(z.x,z.y,z.z),o.push(z.x,z.y,z.z),o.push(z.x,z.y,z.z)},addColor:function(a,t,e){const n=this.colors,o=this.object.geometry.colors;n[a]!==void 0&&o.push(n[a+0],n[a+1],n[a+2]),n[t]!==void 0&&o.push(n[t+0],n[t+1],n[t+2]),n[e]!==void 0&&o.push(n[e+0],n[e+1],n[e+2])},addUV:function(a,t,e){const n=this.uvs,o=this.object.geometry.uvs;o.push(n[a+0],n[a+1]),o.push(n[t+0],n[t+1]),o.push(n[e+0],n[e+1])},addDefaultUV:function(){const a=this.object.geometry.uvs;a.push(0,0),a.push(0,0),a.push(0,0)},addUVLine:function(a){const t=this.uvs;this.object.geometry.uvs.push(t[a+0],t[a+1])},addFace:function(a,t,e,n,o,i,d,h,_){const L=this.vertices.length;let g=this.parseVertexIndex(a,L),y=this.parseVertexIndex(t,L),f=this.parseVertexIndex(e,L);if(this.addVertex(g,y,f),this.addColor(g,y,f),d!==void 0&&d!==""){const u=this.normals.length;g=this.parseNormalIndex(d,u),y=this.parseNormalIndex(h,u),f=this.parseNormalIndex(_,u),this.addNormal(g,y,f)}else this.addFaceNormal(g,y,f);if(n!==void 0&&n!==""){const u=this.uvs.length;g=this.parseUVIndex(n,u),y=this.parseUVIndex(o,u),f=this.parseUVIndex(i,u),this.addUV(g,y,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(a){this.object.geometry.type="Points";const t=this.vertices.length;for(let e=0,n=a.length;e<n;e++){const o=this.parseVertexIndex(a[e],t);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(a,t){this.object.geometry.type="Line";const e=this.vertices.length,n=this.uvs.length;for(let o=0,i=a.length;o<i;o++)this.addVertexLine(this.parseVertexIndex(a[o],e));for(let o=0,i=t.length;o<i;o++)this.addUVLine(this.parseUVIndex(t[o],n))}};return l.startObject("",!1),l}class qe extends c.Loader{constructor(a){super(a),this.materials=null}load(a,t,e,n){const o=this,i=new c.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(a,function(d){try{t(o.parse(d))}catch(h){n?n(h):console.error(h),o.manager.itemError(a)}},e,n)}setMaterials(a){return this.materials=a,this}parse(a){const t=new Ke;a.indexOf(`\r
`)!==-1&&(a=a.replace(/\r\n/g,`
`)),a.indexOf(`\\
`)!==-1&&(a=a.replace(/\\\n/g,""));const e=a.split(`
`);let n="",o="",i=0,d=[];const h=typeof"".trimLeft=="function";for(let g=0,y=e.length;g<y;g++)if(n=e[g],n=h?n.trimLeft():n.trim(),i=n.length,i!==0&&(o=n.charAt(0),o!=="#"))if(o==="v"){const f=n.split(/\s+/);switch(f[0]){case"v":t.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7?(U.setRGB(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6])).convertSRGBToLinear(),t.colors.push(U.r,U.g,U.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":t.uvs.push(parseFloat(f[1]),parseFloat(f[2]));break}}else if(o==="f"){const u=n.slice(1).trim().split(/\s+/),w=[];for(let O=0,A=u.length;O<A;O++){const M=u[O];if(M.length>0){const j=M.split("/");w.push(j)}}const b=w[0];for(let O=1,A=w.length-1;O<A;O++){const M=w[O],j=w[O+1];t.addFace(b[0],M[0],j[0],b[1],M[1],j[1],b[2],M[2],j[2])}}else if(o==="l"){const f=n.substring(1).trim().split(" ");let u=[];const w=[];if(n.indexOf("/")===-1)u=f;else for(let b=0,O=f.length;b<O;b++){const A=f[b].split("/");A[0]!==""&&u.push(A[0]),A[1]!==""&&w.push(A[1])}t.addLineGeometry(u,w)}else if(o==="p"){const u=n.slice(1).trim().split(" ");t.addPointGeometry(u)}else if((d=He.exec(n))!==null){const f=(" "+d[0].slice(1).trim()).slice(1);t.startObject(f)}else if(Ze.test(n))t.object.startMaterial(n.substring(7).trim(),t.materialLibraries);else if(Ye.test(n))t.materialLibraries.push(n.substring(7).trim());else if(Xe.test(n))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(o==="s"){if(d=n.split(" "),d.length>1){const u=d[1].trim().toLowerCase();t.object.smooth=u!=="0"&&u!=="off"}else t.object.smooth=!0;const f=t.object.currentMaterial();f&&(f.smooth=t.object.smooth)}else{if(n==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+n+'"')}t.finalize();const _=new c.Group;if(_.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let g=0,y=t.objects.length;g<y;g++){const f=t.objects[g],u=f.geometry,w=f.materials,b=u.type==="Line",O=u.type==="Points";let A=!1;if(u.vertices.length===0)continue;const M=new c.BufferGeometry;M.setAttribute("position",new c.Float32BufferAttribute(u.vertices,3)),u.normals.length>0&&M.setAttribute("normal",new c.Float32BufferAttribute(u.normals,3)),u.colors.length>0&&(A=!0,M.setAttribute("color",new c.Float32BufferAttribute(u.colors,3))),u.hasUVIndices===!0&&M.setAttribute("uv",new c.Float32BufferAttribute(u.uvs,2));const j=[];for(let V=0,F=w.length;V<F;V++){const R=w[V],B=R.name+"_"+R.smooth+"_"+A;let E=t.materials[B];if(this.materials!==null){if(E=this.materials.create(R.name),b&&E&&!(E instanceof c.LineBasicMaterial)){const k=new c.LineBasicMaterial;c.Material.prototype.copy.call(k,E),k.color.copy(E.color),E=k}else if(O&&E&&!(E instanceof c.PointsMaterial)){const k=new c.PointsMaterial({size:10,sizeAttenuation:!1});c.Material.prototype.copy.call(k,E),k.color.copy(E.color),k.map=E.map,E=k}}E===void 0&&(b?E=new c.LineBasicMaterial:O?E=new c.PointsMaterial({size:1,sizeAttenuation:!1}):E=new c.MeshPhongMaterial,E.name=R.name,E.flatShading=!R.smooth,E.vertexColors=A,t.materials[B]=E),j.push(E)}let p;if(j.length>1){for(let V=0,F=w.length;V<F;V++){const R=w[V];M.addGroup(R.groupStart,R.groupCount,V)}b?p=new c.LineSegments(M,j):O?p=new c.Points(M,j):p=new c.Mesh(M,j)}else b?p=new c.LineSegments(M,j[0]):O?p=new c.Points(M,j[0]):p=new c.Mesh(M,j[0]);p.name=f.name,_.add(p)}else if(t.vertices.length>0){const g=new c.PointsMaterial({size:1,sizeAttenuation:!1}),y=new c.BufferGeometry;y.setAttribute("position",new c.Float32BufferAttribute(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(y.setAttribute("color",new c.Float32BufferAttribute(t.colors,3)),g.vertexColors=!0);const f=new c.Points(y,g);_.add(f)}return _}}const ue=r.defineComponent({__name:"OBJLoader",props:{url:null,position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]},castShadow:{type:Boolean,default:!1},receiveShadow:{type:Boolean,default:!1}},setup(l,{expose:a}){const t=l,e=new qe,n=r.inject("scene"),o=new c.Group;o.castShadow=!0,o.receiveShadow=!0,n.add(o),S(t,"position",o),S(t,"rotation",o),S(t,"scale",o);function i(){e.load(t.url,function(d){for(const h of d.children)o.children.push(h),h.material=o.material,S(t,"position",o,!1),S(t,"rotation",o,!1),S(t,"scale",o,!1)},function(d){console.log(d.loaded/d.total*100+"% loaded")},function(d){console.log("ERROR: OBJ file could not be loaded")})}return i(),r.watch(()=>t.url,()=>i()),r.provide("mesh",o),a({three:o}),(d,h)=>r.renderSlot(d.$slots,"default")}}),fe=r.defineComponent({__name:"AxesHelper",props:{size:{default:1},position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]}},setup(l,{expose:a}){const t=l,e=r.inject("scene"),n=new c.AxesHelper(t.size);return e.add(n),S(t,"position",n),S(t,"rotation",n),S(t,"scale",n),r.provide("mesh",n),a({three:n}),(o,i)=>r.renderSlot(o.$slots,"default")}}),We={name:"BoxGeometry",render:()=>null},me=r.defineComponent({...We,props:{width:{default:1},height:{default:1},depth:{default:1},widthSegments:{default:1},heightSegments:{default:1},depthSegments:{default:1}},setup(l,{expose:a}){const t=l,e=r.inject("mesh");function n(d,h,_,L,g,y){return new c.BoxGeometry(d,h,_,L,g,y)}const o=r.ref(n(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments));e.geometry=o.value;function i(){e.geometry.dispose(),e.geometry=n(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments),o.value=e.geometry}return T(t,"width",i),T(t,"height",i),T(t,"depth",i),T(t,"widthSegments",i),T(t,"heightSegments",i),T(t,"depthSegments",i),a({three:o}),{props:t,mesh:e,makeBox:n,three:o,redoGeometry:i}}}),Je={name:"BufferGeometry",render:()=>null},he=r.defineComponent({...Je,props:{vertices:{default:()=>[]},faces:{default:()=>[]}},setup(l,{expose:a}){const t=l,e=r.inject("mesh");function n(d,h){const _=new c.BufferGeometry,L=new Float32Array(d.length);for(let g=0;g<d.length;g++)L[g]=d[g];return _.setAttribute("position",new c.BufferAttribute(L,3)),_}const o=r.ref(n(t.vertices,t.faces));e.geometry=o.value;function i(d){e.geometry.dispose(),e.geometry=n(d),e.geometry.computeVertexNormals(),o.value=e.geometry}return r.watch(()=>t.vertices,d=>{i(d)},{deep:!0,immediate:!0}),a({three:o}),{props:t,mesh:e,makeGeometry:n,three:o,redoGeometry:i}}}),Qe={name:"PlaneGeometry",render:()=>null},pe=r.defineComponent({...Qe,props:{width:{default:1},height:{default:1},widthSegments:{default:1},heightSegments:{default:1}},setup(l,{expose:a}){const t=l,e=r.inject("mesh");function n(d,h,_,L){return new c.PlaneGeometry(d,h,_,L)}const o=r.ref(n(t.width,t.height,t.widthSegments,t.heightSegments));e.geometry=o.value;function i(){e.geometry.dispose(),e.geometry=n(t.width,t.height,t.widthSegments,t.heightSegments),o.value=e.geometry}return T(t,"width",i),T(t,"height",i),T(t,"widthSegments",i),T(t,"heightSegments",i),a({three:o}),{props:t,mesh:e,makePlane:n,three:o,redoGeometry:i}}}),et={name:"SphereGeometry",render:()=>null},ge=r.defineComponent({...et,props:{radius:{default:1},widthSegments:{default:8},heightSegments:{default:6},phiStart:{default:0},phiLength:{default:2*Math.PI},thetaStart:{default:0},thetaLength:{default:Math.PI}},setup(l,{expose:a}){const t=l,e=r.inject("mesh");function n(d,h,_,L,g,y,f){return new c.SphereGeometry(d,h,_,L,g,y,f)}const o=r.ref(n(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength));e.geometry=o.value;function i(){e.geometry.dispose(),e.geometry=n(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength),o.value=e.geometry}return T(t,"radius",i),T(t,"widthSegments",i),T(t,"heightSegments",i),T(t,"phiStart",i),T(t,"phiLength",i),T(t,"thetaStart",i),T(t,"thetaLength",i),a({three:o}),{props:t,mesh:e,makeSphere:n,three:o,redoGeometry:i}}}),tt={name:"MeshBasicMaterial"},be=r.defineComponent({...tt,props:{color:{default:16777215},side:{default:c.FrontSide}},setup(l,{expose:a}){const t=l,e=r.inject("mesh"),n=new c.MeshBasicMaterial;e.material=n;function o(i){i.color&&(n.color=new c.Color(i.color)),i.side&&(n.side=i.side)}return o(t),r.watch(()=>t.color,()=>o(t)),r.watch(()=>t.side,()=>o(t)),r.provide("material",n),a({three:n}),(i,d)=>r.renderSlot(i.$slots,"default")}}),nt={name:"MeshLambertMaterial"},ye=r.defineComponent({...nt,props:{color:{default:16777215},side:{default:c.FrontSide}},setup(l,{expose:a}){const t=l,e=r.inject("mesh"),n=new c.MeshLambertMaterial;e.material=n;function o(i){i.color&&(n.color=new c.Color(i.color)),i.side&&(n.side=i.side)}return o(t),r.watch(()=>t.color,()=>o(t)),r.watch(()=>t.side,()=>o(t)),r.provide("material",n),a({three:n}),(i,d)=>r.renderSlot(i.$slots,"default")}}),ot={name:"PointsMaterial",render:()=>null},we=r.defineComponent({...ot,props:{color:{default:16777215},sizeAttenuation:{type:Boolean,default:!0},size:{default:1}},setup(l,{expose:a}){const t=l,e=r.inject("mesh"),n=new c.PointsMaterial({color:t.color,sizeAttenuation:t.sizeAttenuation,size:t.size});e.material=n;function o(i){i.color&&(n.color=new c.Color(i.color)),i.size&&(n.size=i.size),i.sizeAttenuation!==void 0&&(n.sizeAttenuation=i.sizeAttenuation)}return o(t),r.watch(()=>t.color,()=>o(t)),r.watch(()=>t.size,()=>o(t)),r.watch(()=>t.sizeAttenuation,()=>o(t)),r.provide("material",n),a({three:n}),{props:t,mesh:e,three:n,applyProps:o}}}),st={name:"AmbientLight",render:()=>null},_e=r.defineComponent({...st,props:{color:{default:16777215},intensity:{default:1}},setup(l,{expose:a}){const t=l,e=r.inject("scene"),n=new c.AmbientLight;e.add(n);function o(i){n.color=new c.Color(i.color),n.intensity=i.intensity}return o(t),r.watch(()=>t.color,()=>o(t)),r.watch(()=>t.intensity,()=>o(t)),a({three:n}),{props:t,scene:e,three:n,applyProps:o}}}),at={name:"PointLight",render:()=>null},Pe=r.defineComponent({...at,props:{position:{default:()=>[0,0,0]},rotation:{default:()=>[0,0,0]},scale:{default:()=>[1,1,1]},color:{default:16777215},intensity:{default:1},castShadow:{type:Boolean,default:!1}},setup(l,{expose:a}){const t=l,e=r.inject("scene"),n=new c.PointLight;e.add(n),S(t,"position",n),S(t,"rotation",n),S(t,"scale",n);function o(i){n.color=new c.Color(i.color),n.intensity=i.intensity,n.castShadow=i.castShadow}return o(t),r.watch(()=>t.color,()=>o(t)),r.watch(()=>t.intensity,()=>o(t)),r.watch(()=>t.castShadow,()=>o(t)),a({three:n}),{props:t,scene:e,three:n,applyProps:o}}}),it={name:"Texture",render:()=>null},Se=r.defineComponent({...it,props:{url:null},setup(l,{expose:a}){const t=l,e=r.inject("material"),n=r.ref(new c.Texture);function o(i){"map"in e&&(e.map=new c.TextureLoader().load(i.url))}return o(t),r.watch(()=>t.url,()=>o(t)),a({three:n}),{props:t,material:e,three:n,applyProps:o}}});function rt(l){l.component("Renderer",W),l.component("Scene",J),l.component("PerspectiveCamera",te),l.component("OrthographicCamera",ne),l.component("OrbitControls",ae),l.component("Mesh",ie),l.component("Points",re),l.component("OBJLoader",ue),l.component("AxesHelper",fe),l.component("BoxGeometry",me),l.component("BufferGeometry",he),l.component("PlaneGeometry",pe),l.component("SphereGeometry",ge),l.component("MeshBasicMaterial",be),l.component("MeshLambertMaterial",ye),l.component("PointsMaterial",we),l.component("AmbientLight",_e),l.component("PointLight",Pe),l.component("Texture",Se)}P.AmbientLight=_e,P.AxesHelper=fe,P.BoxGeometry=me,P.BufferGeometry=he,P.Mesh=ie,P.MeshBasicMaterial=be,P.MeshLambertMaterial=ye,P.OBJLoader=ue,P.OrbitControls=ae,P.OrthographicCamera=ne,P.PerspectiveCamera=te,P.PlaneGeometry=pe,P.PointLight=Pe,P.Points=re,P.PointsMaterial=we,P.Renderer=W,P.Scene=J,P.SphereGeometry=ge,P.Texture=Se,P.install=rt,Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})});
